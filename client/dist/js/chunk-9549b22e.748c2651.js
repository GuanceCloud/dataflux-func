(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9549b22e"],{"03d1":function(e,t,a){},3258:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"fade"}},[e.$store.state.isLoaded?a("el-container",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullScreenLoading,expression:"fullScreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{direction:"vertical","element-loading-spinner":"el-icon-loading","element-loading-text":e.progressTip||e.$t("Processing...")}},[a("el-header",{attrs:{height:"60px"}},[a("h1",[e._v("\n        "+e._s(e.$t("File Tool"))+"\n\n        　\n        "),a("el-tooltip",{attrs:{content:e.$t("Go Up")}},[a("el-button",{attrs:{disabled:"/"===e.currentFolder,size:"small"},on:{click:function(t){return e.enterFolder("..")}}},[a("i",{staticClass:"fa fa-fw fa-arrow-up"})])],1),e._v(" "),a("el-tooltip",{attrs:{content:e.$t("Refresh")}},[a("el-button",{staticClass:"compact-button",attrs:{size:"small"},on:{click:function(t){return e.loadData({isRefresh:!0})}}},[a("i",{staticClass:"fa fa-fw fa-refresh"})])],1),e._v("\n\n        　\n        "),a("el-popover",{attrs:{placement:"bottom",width:"240"},model:{value:e.showMkdirPopover,callback:function(t){e.showMkdirPopover=t},expression:"showMkdirPopover"}},[a("div",{staticClass:"popover-input"},[a("el-input",{ref:"mkdirName",attrs:{size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.resourceOperation(e.mkdirName,"mkdir")}},model:{value:e.mkdirName,callback:function(t){e.mkdirName=t},expression:"mkdirName"}}),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.resourceOperation(e.mkdirName,"mkdir")}}},[e._v(e._s(e.$t("Add")))])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[a("i",{staticClass:"fa fa-fw fa-plus"}),e._v("\n            "+e._s(e.$t("Folder"))+"\n          ")])],1),e._v(" "),a("el-tooltip",{attrs:{content:""+e.$t("File size limit")+e.$t(":")+" "+e.T.byteSizeHuman(e.$store.getters.CONFIG("_EX_UPLOAD_RESOURCE_FILE_SIZE_LIMIT")),placement:"bottom"}},[a("el-upload",{ref:"upload",staticClass:"upload-button",attrs:{limit:2,multiple:!1,"auto-upload":!0,"show-file-list":!1,"http-request":e.handleUpload,"on-change":e.onUploadFileChange,action:""}},[a("el-button",{attrs:{size:"small"}},[a("i",{staticClass:"fa fa-fw fa-cloud-upload"}),e._v("\n              "+e._s(e.$t("Upload"))+"\n            ")])],1)],1),e._v("\n\n        　\n        "),"/"!==e.currentFolder?a("code",{staticClass:"resource-navi"},[a("small",[e._v(e._s(e.$t("Path"))+e._s(e.$t(":")))]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.enterFolder()}}},[a("i",{staticClass:"fa fa-fw fa-home"})]),e._l(e.currentFolder.slice(1).split("/"),(function(t,r){return[a("div",{staticClass:"path-sep"},[a("i",{staticClass:"fa fa-angle-right"})]),a("el-button",{key:r,attrs:{size:"small"},on:{click:function(t){e.enterFolder(e.currentFolder.split("/").slice(0,r+2).join("/"),!0)}}},[e._v("\n              "+e._s(t)+"\n            ")])]}))],2):e._e(),e._v(" "),a("div",{staticClass:"header-control"})],1)]),e._v(" "),a("el-main",{staticClass:"common-table-container"},[a("el-table",{staticClass:"common-table",attrs:{height:"100%",data:e.files}},[a("el-table-column",{attrs:{label:e.$t("Name"),sortable:"","sort-by":"name"},scopedSlots:e._u([{key:"default",fn:function(t){return["folder"===t.row.type?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.enterFolder(t.row.name)}}},[a("i",{class:"fa fa-fw fa-"+t.row.icon}),e._v(" "),a("code",[e._v(e._s(t.row.name)+"/")])]):[a("i",{class:"fa fa-fw fa-"+t.row.icon}),e._v(" "),a("code",[e._v(e._s(t.row.name))])]]}}],null,!1,3974677915)}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("Create time"),sortable:"","sort-by":"createTime",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("datetime")(t.row.createTime)))]),e._v(" "),a("br"),e._v(" "),a("span",{staticClass:"text-info"},[e._v(e._s(e._f("fromNow")(t.row.createTime)))])]}}],null,!1,273918412)}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("Update time"),sortable:"","sort-by":"updateTime",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("datetime")(t.row.updateTime)))]),e._v(" "),a("br"),e._v(" "),a("span",{staticClass:"text-info"},[e._v(e._s(e._f("fromNow")(t.row.updateTime)))])]}}],null,!1,2026574796)}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("Size"),sortable:"","sort-by":"size",align:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.size?a("code",[e._v(e._s(t.row.sizeHuman))]):e._e()]}}],null,!1,2118104871)}),e._v(" "),a("el-table-column",{attrs:{align:"right",width:"260","class-name":"fix-list-button"},scopedSlots:e._u([{key:"default",fn:function(t){return["folder"===t.row.type?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.enterFolder(t.row.name)}}},[e._v(e._s(e.$t("Enter")))]):"file"===t.row.type?[e.previewExtMap[t.row.ext]?a("el-link",{attrs:{type:"primary",href:t.row.previewURL,underline:!1,target:"_blank"}},[e._v(e._s(e.$t("Preview")))]):e._e(),e._v(" "),a("el-link",{attrs:{type:"primary",href:t.row.downloadURL,download:t.row.name,underline:!1,target:"_blank"}},[e._v(e._s(e.$t("Download")))])]:e._e(),e._v(" "),a("el-dropdown",{on:{command:e.resourceOperationCmd}},[a("el-button",{attrs:{type:"text"}},[e._v("\n                "+e._s(e.$t("More"))),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["zip"===t.row.ext?a("el-dropdown-item",{attrs:{command:{data:t.row,operation:"unzip"}}},[e._v(e._s(e.$t("Unzip")))]):a("el-dropdown-item",{attrs:{command:{data:t.row,operation:"zip"}}},[e._v(e._s(e.$t("Zip")))]),e._v(" "),a("el-dropdown-item",{attrs:{command:{data:t.row,operation:"cp"}}},[e._v(e._s(e.$t("Copy")))]),e._v(" "),a("el-dropdown-item",{attrs:{command:{data:t.row,operation:"mv"}}},[e._v(e._s(e.$t("Move")))]),e._v(" "),a("el-dropdown-item",{attrs:{command:{data:t.row,operation:"rm"}}},[e._v(e._s(e.$t("Delete")))])],1)],1)]}}],null,!1,3947672136)})],1)],1)],1):e._e()],1)},n=[],o=a("a6db"),i=(a("e756"),a("e5ac"),a("60da"),a("977b"),a("bd06"),a("fbe6"),a("e62f"),a("74f5"),a("672e"),a("d44b"),47),s=92,l=46;function c(e){return e===i||e===s}function u(e){return e===i}function d(e){if(0===e.length)return".";var t=e.charCodeAt(0)===i,a=e.charCodeAt(e.length-1)===i;return e=p(e,!t,"/",u),0!==e.length||t||(e="."),e.length>0&&a&&(e+="/"),t?"/"+e:e}function p(e,t,a,r){for(var n,o="",s=0,c=-1,u=0,d=0;d<=e.length;++d){if(d<e.length)n=e.charCodeAt(d);else{if(r(n))break;n=i}if(r(n)){if(c===d-1||1===u);else if(c!==d-1&&2===u){if(o.length<2||2!==s||o.charCodeAt(o.length-1)!==l||o.charCodeAt(o.length-2)!==l)if(o.length>2){var p=o.lastIndexOf(a);if(p!==o.length-1){-1===p?(o="",s=0):(o=o.slice(0,p),s=o.length-1-o.lastIndexOf(a)),c=d,u=0;continue}}else if(2===o.length||1===o.length){o="",s=0,c=d,u=0;continue}t&&(o.length>0?o+="".concat(a,".."):o="..",s=2)}else o.length>0?o+=a+e.slice(c+1,d):o=e.slice(c+1,d),s=d-c-1;c=d,u=0}else n===l&&-1!==u?++u:u=-1}return o}function f(){if(0===arguments.length)return".";for(var e,t,a=arguments[0].indexOf("/")>-1?"/":"\\",r=0;r<arguments.length;++r){var n=arguments[r];n.length>0&&(void 0===e?e=t=n:e+=a+n)}if(void 0===e)return".";var o=!0,i=0;if(c(t.charCodeAt(0))){++i;var s=t.length;s>1&&c(t.charCodeAt(1))&&(++i,s>2&&(c(t.charCodeAt(2))?++i:o=!1))}if(o){for(;i<e.length;++i)if(!c(e.charCodeAt(i)))break;i>=2&&(e=a+e.slice(i))}return d(e)}var m={name:"FileManager",components:{},watch:{$route:{immediate:!0,handler:function(e,t){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.loadData();case 2:case"end":return e.stop()}}),e)})))()}},showMkdirPopover:function(e){var t=this;e?this.$nextTick((function(){t.$refs.mkdirName.focus()})):this.mkdirName=""}},methods:{loadData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,n,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e=e||{},e.isRefresh&&t.$store.commit("updateLoadStatus",!1),r=t.T.createListQuery(),a.next=6,t.T.callAPI_get("/api/v1/resources/dir",{query:r});case 6:if(n=a.sent,n.ok){a.next=9;break}return a.abrupt("return");case 9:o=n.data,i={},o.forEach((function(e){switch(i[e.name]=!0,e.type){case"folder":e.icon="folder-o";break;case"file":e.icon="file-o",e.ext=e.name.split(".").pop(),e.size&&(e.sizeHuman=t.T.byteSizeHuman(e.size)),e.previewURL=t.T.formatURL("/api/v1/resources",{baseURL:!0,auth:!0,query:{preview:!0,filePath:t.getPath(e.name)}}),e.downloadURL=t.T.formatURL("/api/v1/resources",{baseURL:!0,auth:!0,query:{filePath:t.getPath(e.name)}});break}switch(e.ext){case"zip":case"rar":case"7z":case"tar":case"gz":e.icon="file-archive-o";break;case"htm":case"html":case"js":case"css":case"yaml":case"json":case"py":e.icon="file-code-o";break;case"jpg":case"jpeg":case"png":case"gif":case"bmp":e.icon="file-image-o";break;case"pdf":e.icon="file-pdf-o";break;case"txt":case"csv":case"md":case"markdown":e.icon="file-text-o";break;case"avi":case"mp4":case"mkv":e.icon="file-video-o";break;case"doc":case"docx":e.icon="file-word-o";break;case"xls":case"xlsx":e.icon="file-excel-o";break;case"ppt":case"pptx":e.icon="file-powerpoint-o";break}})),o.sort((function(e,t){return e.type!==t.type?"folder"===e.type?-1:1:e.name!==t.name?e.name<t.name?-1:1:0})),t.files=o,t.fileNameMap=i,t.$store.commit("updateLoadStatus",!0);case 16:case"end":return a.stop()}}),a)})))()},getPath:function(e){return f(this.currentFolder,e)},enterFolder:function(e,t){this.dataFilter.folder=e?t?e:this.getPath(e):"/",this.T.changePageFilter(this.dataFilter)},resourceOperationCmd:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e){a.next=2;break}return a.abrupt("return");case 2:return r=e.data.name,n=e.operation,a.next=6,t.resourceOperation(r,n);case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}}),a)})))()},resourceOperation:function(e,t){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=null,r.t0=t,r.next="cp"===r.t0?4:"mv"===r.t0?10:"rm"===r.t0?16:21;break;case 4:return r.next=6,a.T.prompt(a.$t("Please input destination path"),e);case 6:if(n=r.sent,n){r.next=9;break}return r.abrupt("return");case 9:return r.abrupt("break",21);case 10:return r.next=12,a.T.prompt(a.$t("Please input destination path"),"./".concat(e));case 12:if(n=r.sent,n){r.next=15;break}return r.abrupt("return");case 15:return r.abrupt("break",21);case 16:return r.next=18,a.T.confirm(a.$t("Are you sure you want to delete the following content?"));case 18:if(r.sent){r.next=20;break}return r.abrupt("return");case 20:return r.abrupt("break",21);case 21:return o=setTimeout((function(){a.fullScreenLoading=!0}),200),r.next=24,a.T.callAPI("post","/api/v1/resources/operate",{body:{targetPath:a.getPath(e),operation:t,operationArgument:n}});case 24:if(i=r.sent,clearTimeout(o),a.fullScreenLoading=!1,i.ok){r.next=29;break}return r.abrupt("return",a.loadData());case 29:r.t1=t,r.next="mkdir"===r.t1?32:37;break;case 32:return a.showMkdirPopover=!1,a.mkdirName="",r.next=36,a.enterFolder(e);case 36:return r.abrupt("break",40);case 37:return r.next=39,a.loadData();case 39:return r.abrupt("break",40);case 40:case"end":return r.stop()}}),r)})))()},handleUpload:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,n,o,i,s,l,c,u,d,p,f,m,h,b,v;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=t.$store.getters.CONFIG("_EX_UPLOAD_RESOURCE_FILE_SIZE_LIMIT"),!(e.file.size>r)){a.next=4;break}return n=t.T.byteSizeHuman(r),a.abrupt("return",t.T.alert(t.$t("File too large (size limit: {size})",{size:n})));case 4:if(o=e.file.name,i=null,!t.fileNameMap[o]){a.next=32;break}s=null,a.prev=8,l=o.split("."),c="",l.length>1&&(c=".".concat(l.pop())),u=l.join("."),d=null,p=2;case 15:if(d="".concat(u,"-").concat(p).concat(c),t.fileNameMap[d]){a.next=19;break}return a.abrupt("break",22);case 19:p++,a.next=15;break;case 22:return a.next=24,t.$prompt(t.$t('File <code class="text-main">{name}</code> already existed, please input a new name',{name:o}),t.$t("Upload"),{customClass:"uploadRename",inputValue:d,dangerouslyUseHTMLString:!0,closeOnClickModal:!1,confirmButtonText:t.$t("Upload"),cancelButtonText:t.$t("Cancel"),inputValidator:function(e){if(t.fileNameMap[e])return t.$t("File already existed")}});case 24:s=a.sent,a.next=31;break;case 27:return a.prev=27,a.t0=a["catch"](8),t.$refs.upload.clearFiles(),a.abrupt("return");case 31:i=s.value;case 32:return f=new FormData,f.append("files",e.file),f.append("folder",t.dataFilter.folder||"."),i&&f.append("rename",i),m=setTimeout((function(){t.fullScreenLoading=!0}),200),h=null,b=null,v=t.T.throttle((function(e){t.progressTip=e}),500),a.next=42,t.T.callAPI("post","/api/v1/resources",{body:f,alert:{okMessage:t.$t("File uploaded")},onUploadProgress:function(e){var a="".concat(t.$t("Uploading {filename}",{filename:i||o}));if(h&&b){var r=(e.loaded/e.total*100).toFixed(2),n=(e.loaded-b)/(e.timeStamp-h)*1e3;a+=" (".concat(r,"%, ").concat(t.T.byteSizeHuman(e.loaded),"/").concat(t.T.byteSizeHuman(e.total),", ").concat(t.T.byteSizeHuman(n),"/s)")}h=e.timeStamp,b=e.loaded,v(a)}});case 42:return a.sent,clearTimeout(m),t.fullScreenLoading=!1,t.progressTip="",a.next=48,t.loadData();case 48:t.$refs.upload.clearFiles();case 49:case"end":return a.stop()}}),a,null,[[8,27]])})))()},onUploadFileChange:function(e,t){t.length>1&&t.splice(0,1)}},computed:{previewExtMap:function(){return{jpg:!0,jpeg:!0,png:!0,bmp:!0,gif:!0,mp4:!0,pdf:!0,txt:!0,md:!0}},currentFolder:function(){return this.dataFilter.folder||"/"}},props:{},data:function(){var e=this.T.createListQuery();return{files:[],fileNameMap:{},showMkdirPopover:!1,mkdirName:"",fullScreenLoading:!1,progressTip:"",dataFilter:{folder:e.folder}}}},h=m,b=(a("cc2e"),a("eb89"),a("0620")),v=a("8fd5"),_=Object(b["a"])(h,r,n,!1,null,"6bdfc86c",null);"function"===typeof v["default"]&&Object(v["default"])(_);t["default"]=_.exports},"74f5":function(e,t,a){e.exports=a("7ab4")(1131)},"8b41":function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-CN":{"File Tool":"文件管理器","Go Top":"返回顶层","Go Up":"向上","File size limit":"文件大小限制","Path":"路径","Create time":"创建时间","Update time":"更新时间","File uploaded":"文件已上传","Please input destination path":"请输入目标路径","File <code class=\\"text-main\\">{name}</code> already existed, please input a new name":"文件 <code class=\\"text-main\\">{name}</code> 已经存在，请输入新文件名","Are you sure you want to delete the following content?":"是否确定删除此内容？","Delete file":"删除文件","File already existed":"文件已经存在","File too large (size limit: {size})":"文件过大（大小限制：{size}）","Uploading {filename}":"正在上传 {filename}","Processing...":"正在处理..."}}'),delete e.options._Ctor}},"8fd5":function(e,t,a){"use strict";var r=a("8b41"),n=a.n(r);t["default"]=n.a},bf7f:function(e,t,a){},cc2e:function(e,t,a){"use strict";a("03d1")},eb89:function(e,t,a){"use strict";a("bf7f")}}]);
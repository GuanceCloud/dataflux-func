(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a9ac8e9c"],{"0162":function(t,e,n){},"02ec":function(t,e,n){var i=n("23e7"),r=n("67b6");i({target:"String",proto:!0,name:"trimStart",forced:"".trimLeft!==r},{trimLeft:r})},"06c5":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("fb6a"),n("d3b7"),n("25f0"),n("b0c0"),n("a630"),n("3ca3"),n("ac1f"),n("00b4");var i=n("6b75");function r(t,e){if(t){if("string"===typeof t)return Object(i["a"])(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(i["a"])(t,e):void 0}}},"0797":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"zh-CN":{"Download as a text file":"作为文本文件下载"}}'),delete t.options._Ctor}},"14e96":function(t,e,n){"use strict";var i=n("24e1"),r=n.n(i);e["default"]=r.a},"1ff2":function(t,e,n){"use strict";n("5721")},"21a6":function(t,e,n){(function(n){var i,r,o;(function(n,a){r=[],i=a,o="function"===typeof i?i.apply(e,r):i,void 0===o||(t.exports=o)})(0,(function(){"use strict";function e(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function i(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){c(i.response,e,n)},i.onerror=function(){console.error("could not download file")},i.send()}function r(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function o(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(i){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(t,e,n){var s=a.URL||a.webkitURL,c=document.createElement("a");e=e||t.name||"download",c.download=e,c.rel="noopener","string"==typeof t?(c.href=t,c.origin===location.origin?o(c):r(c.href)?i(t,e,n):o(c,c.target="_blank")):(c.href=s.createObjectURL(t),setTimeout((function(){s.revokeObjectURL(c.href)}),4e4),setTimeout((function(){o(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,a){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,a),n);else if(r(t))i(t,n,a);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout((function(){o(s)}))}}:function(t,e,n,r){if(r=r||open("","_blank"),r&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return i(t,e,n);var o="application/octet-stream"===t.type,c=/constructor/i.test(a.HTMLElement)||a.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||o&&c||s)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=l?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},u.readAsDataURL(t)}else{var d=a.URL||a.webkitURL,p=d.createObjectURL(t);r?r.location=p:location.href=p,r=null,setTimeout((function(){d.revokeObjectURL(p)}),4e4)}});a.saveAs=c.saveAs=c,t.exports=c}))}).call(this,n("c8ba"))},"24e1":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"zh-CN":{"Script Setup":"脚本设置","Script is under editing in other tab, please wait...":"其他标签页或窗口正在编辑此脚本，请稍后...","Script is under editing in other client, please wait...":"其他客户端正在编辑此脚本，请稍后...","Select Target":"选择跳转目标","Viewport are too narrow":"当前可视宽度太窄","Writing test cases to test your Func is recommended":"建议编写测试用例来测试您的函数","Args":"参数","Arguments should be inputed like {\\"arg\\": value}.":"参数以 {\\"参数名\\": 参数值} 方式填写。","Leave blank or {} when no argument":"没有参数的不用填写，或保留 {}","Arguments (JSON)":"参数（JSON格式）","Run selected Func":"执行指定的函数","Shortcut":"快捷键","Save Script draft":"保存草稿","Show code diff":"查看差异","DIFF":"差异","Save and publish Script":"保存并发布","Recover code to latest published version":"恢复代码为上次发布的版本","End editing":"结束编辑","Code Editor setting":"代码编辑器设置","This is a built-in Script, code will be reset when the system restarts":"这是一个内置脚本，代码会在系统重启后复位","This Script is locked by other user ({user})":"当前脚本被其他用户（{user}）锁定","addedLines":"新增 {n} 行","removedLines":"，删除 {n} 行","codeLines":"共 {n} 行代码","codeLinesPrev":"修改前共 {n} 行代码","codeLinesCurr":"，修改后共 {n} 行代码","Script is modified but NOT published yet":"脚本已修改但尚未发布","Script is published":"脚本已发布","Diff between published and previously published":"发布前后差异","Clear highlighted":"清除高亮","Close":"关闭","Output":"输出","Func exection result or log message will be shown here":"函数执行结果与日志信息将显示在此处","Operating too frequently or Script is modified in other tab":"操作过于频繁，或脚本已经在其他窗口被修改。","Do you want to download current editing Script?":"是否下载当前正在编辑的脚本？","Saving Script failed":"保存脚本失败","Current editing Script has been downloaded":"当前正在编辑的脚本已经下载","Script saved successfully":"脚本保存成功","You can continue with other operations":"你可以继续进行其他操作","Published Code":"已发布的代码","Saved Draft Code":"已保存的草稿代码","Script will take effect after been published immediately,":"发布后新的脚本将立即生效，","Funcs with {html} decorator will be available to be accessed":"被{html}装饰的函数可被访问","Are you sure you want to publish the Script?":"是否确认发布此脚本？","Publish Script":"发布脚本","Script saved":"脚本已保存","Script published, new Script is in effect immediately":"脚本已发布，新脚本立即生效","Reset draft to the last published version, changes not published will lost":"复位脚本草稿到上次发布时的状态，未发布的草稿将丢失","Are you sure you want to reset the Script?":"是否确认复位此脚本？","Script has been reset to previous version":"脚本已经复位到上一个版本","Reset Script":"复位脚本","The parameter is not a valid JSON":"调用参数不是有效的JSON格式","Invalid argument format":"参数格式不正确","Check input":"输入检查","seconds":"{n} 秒","Executed Func":"执行函数","This Script is not published, it will take effect after the Script is published":"当前脚本尚未发布，脚本只有发布后才会生效","Do you want to publish the Script now?":"是否现在发布？","Script not published":"脚本未发布","Publish Now":"立即发布","Skip Publishing":"跳过发布","Run Time":"函数执行耗时","Peak Memory Allocated":"内存分配峰值","It took too much time for running (more than 3s), may not be suitable for synchronous calling scenario":"耗时较长（大于 3 秒），可能不适合需要响应速度较高的场景","Func Return Value (repr)":"函数返回值（repr）","Stack":"错误堆栈","Publish Failed":"发布失败","Script Error":"脚本错误","Waiting Timeout":"等待超时","Duplicated Func names":"函数名重复","Script publishing failed. Please check your code":"脚本发布失败，请检查代码是否存在错误","Script executing failed. Please check your code":"脚本执行失败，请检查代码是否存在错误","Script publishing failed. Script executing module may crashed, please contact the administrator to report this issue":"脚本发布时发生故障，后端脚本执行模块可能存在问题，请联系管理员排查问题","Script executing failed. Script executing module may crashed, please contact the administrator to report this issue":"脚本执行时发生故障，后端脚本执行模块可能存在问题，请联系管理员排查问题","Detail information is shown in the output box bellow":"详细信息可在下方输出窗口中查看","Script publishing timeout, please make sure that no time-consuming code in global scope":"脚本发布预检查超时，请注意不要再全局范围内编写耗时代码","If this issue persists, please contact the administrator to report this issue":"如果问题持续出现，请联系管理员排查问题","Waiting Func response timeout":"等待函数响应超时","There is a {seconds} time limit when calling Funcs in Code Editor":"在编辑器中运行函数时，最多允许执行{seconds}，超时会自动中断执行","It is not recommended for synchronous calling Funcs that response slowly":"正式使用时应注意响应过慢的函数不适合同步方式调用","Can not parse return value":"函数返回值无法解析","Func returned a value that can not been parsed as JSON. Please check your code":"函数返回了无法使用 JSON 表示的数据，请检查代码","In general, common used types are safe (e.g. list, dict, int, float, str, bool, None).":"一般来说，Python 常用基本类型都能正常解析，如 list、dict、int、float、str、bool、None 等。","Some math lib may return complicated values, like numpy.NaN. These values should be converted to common used types before returning":"但一些数学库可能返回复杂的数字对象，如 numpy.NaN。这些数字对象需要在函数返回前处理成 Python 的基本类型","Duplicated names of Funcs decorated by @DFF.API(...)":"被@DFF.API(...)装饰的函数存在重名","Please check the code and try again":"请检查代码，修改后再试一次","Publishing Script, it will be finished in a few seconds. If the page is not responding for a long time, please try refreshing.":"脚本发布中，正常几秒就能完成。如长时间无响应请尝试刷新页面","Func is running. If it is not responding for a long time, please try refreshing.":"函数执行中，长时间无响应后再尝试刷新页面","Func is running. It will wait at most {seconds} for the result. If it is not responding for a long time, please try refreshing.":"函数执行中，执行最多等待 {seconds}，长时间无响应后再尝试刷新页面"}}'),delete t.options._Ctor}},"364f":function(t,e,n){"use strict";n("842a")},"3aac":function(t,e,n){},"484b":function(t,e,n){"use strict";n("0162")},5721:function(t,e,n){},"5a45":function(t,e,n){"use strict";n("a4d3"),n("e01a");var i=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{id:"FeatureNotice",visible:t.show&&!t.disabled,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"850px"}},[e("div",{staticClass:"notice-feature-container"},[e("el-image",{attrs:{src:t.image}}),t._v(" "),e("el-card",{staticClass:"notice-feature-content"},[e("i",{staticClass:"fa fa-fw notice-feature-icon",class:t.icon}),t._v(" "),e("p",{domProps:{innerHTML:t._s(t.description)}})]),t._v(" "),e("div",{staticClass:"notice-feature-buttons"},[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.close(!0)}}},[t._v(t._s(t.$t("Don't prompt again")))]),t._v(" "),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.close()}}},[t._v(t._s(t.$t("OK")))])],1)],1)])},r=[],o=n("a92d"),a=n.n(o),s={name:"FeatureNoticeDialog",components:{},watch:{},methods:{close:function(t){this.show=!1,this.$store.commit("dismissFeatureNotice",this.featureKey),t&&this.$store.commit("disableFeatureNotice",this.featureKey)}},computed:{},props:{featureKey:String,description:String,icon:{type:String,default:"fa-lightbulb-o"},image:{type:Object,default:a.a},disabled:{type:Boolean,default:!1}},data:function(){return{show:!1}},mounted:function(){var t=this;setTimeout((function(){t.$store.getters.showFeatureNotice(t.featureKey)&&(t.show=!0)}),500)}},c=s,l=(n("364f"),n("1ff2"),n("2877")),u=n("928e"),d=Object(l["a"])(c,i,r,!1,null,"57f7fbfa",null);"function"===typeof u["default"]&&Object(u["default"])(d);e["a"]=d.exports},"5afa":function(t,e,n){"use strict";n("d612")},"67b6":function(t,e,n){"use strict";var i=n("58a8").start,r=n("c8d2");t.exports=r("trimStart")?function(){return i(this)}:"".trimStart},"68fc":function(t,e,n){"use strict";n("8026")},"6b75":function(t,e,n){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}n.d(e,"a",(function(){return i}))},"753f":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"addedLines":"Added {n} line | Added {n} lines","removedLines":", Removed {n} Line | , Removed {n} Lines","codeLines":"{n} line | {n} lines","codeLinesPrev":"previously {n} line | previously {n} lines","codeLinesCurr":", currently {n} line| , currently {n} lines","seconds":"{n} second | {n} seconds"}}'),delete t.options._Ctor}},"7abf":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"zh-CN":{"Code Editor setting":"代码编辑器设置","Setting of Code Editor only effect current browser":"代码编辑器配置仅保存在当前浏览器，更换浏览器或电脑后需要重新配置","Theme":"主题","Font Size":"文字大小","Line Height":"行高","Reset to default":"恢复默认设置","Please input font size":"请输入文字大小","Font size should be a integer between 12 and 36":"文字大小设置范围为 12-36 px","Please input line height":"请输入行高","Line height should be a number between 1 and 2":"行高设置范围为 1-2 倍"}}'),delete t.options._Ctor}},"7b0b4":function(t,e,n){"use strict";var i=n("0797"),r=n.n(i);e["default"]=r.a},8026:function(t,e,n){},"842a":function(t,e,n){},"8b57":function(t,e,n){},"928e":function(t,e,n){"use strict";var i=n("a5bc"),r=n.n(i);e["default"]=r.a},9667:function(t,e,n){"use strict";var i=n("753f"),r=n.n(i);e["default"]=r.a},a1f0:function(t,e,n){"use strict";var i=n("23e7"),r=n("c65b"),o=n("e330"),a=n("9ed3"),s=n("1d80"),c=n("50c4"),l=n("577e"),u=n("825a"),d=n("c6b6"),p=n("44e7"),f=n("90d8"),h=n("dc4a"),m=n("cb2d"),g=n("d039"),b=n("b622"),v=n("4840"),w=n("8aa5"),S=n("14c3"),_=n("69f3"),y=n("c430"),k=b("matchAll"),C="RegExp String",I=C+" Iterator",T=_.set,x=_.getterFor(I),E=RegExp.prototype,$=TypeError,M=o("".indexOf),O=o("".matchAll),L=!!O&&!g((function(){O("a",/./)})),P=a((function(t,e,n,i){T(this,{type:I,regexp:t,string:e,global:n,unicode:i,done:!1})}),C,(function(){var t=x(this);if(t.done)return{value:void 0,done:!0};var e=t.regexp,n=t.string,i=S(e,n);return null===i?{value:void 0,done:t.done=!0}:t.global?(""===l(i[0])&&(e.lastIndex=w(n,c(e.lastIndex),t.unicode)),{value:i,done:!1}):(t.done=!0,{value:i,done:!1})})),D=function(t){var e,n,i,r=u(this),o=l(t),a=v(r,RegExp),s=l(f(r));return e=new a(a===RegExp?r.source:r,s),n=!!~M(s,"g"),i=!!~M(s,"u"),e.lastIndex=c(r.lastIndex),new P(e,o,n,i)};i({target:"String",proto:!0,forced:L},{matchAll:function(t){var e,n,i,o,a=s(this);if(null!=t){if(p(t)&&(e=l(s(f(t))),!~M(e,"g")))throw $("`.matchAll` does not allow non-global regexes");if(L)return O(a,t);if(i=h(t,k),void 0===i&&y&&"RegExp"==d(t)&&(i=D),i)return r(i,t,a)}else if(L)return O(a,t);return n=l(a),o=new RegExp(t,"g"),y?r(D,o,n):o[k](n)}}),y||k in E||m(E,k,D)},a5bc:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"zh-CN":{"Don\'t prompt again":"不再提示"}}'),delete t.options._Ctor}},a630:function(t,e,n){var i=n("23e7"),r=n("4df4"),o=n("1c7e"),a=!o((function(t){Array.from(t)}));i({target:"Array",stat:!0,forced:a},{from:r})},a92d:function(t,e,n){t.exports=n.p+"img/notice-feature.a3847dd5.png"},b3ba:function(t,e,n){t.exports=n.p+"img/notice-monkey-patch.00b3ec12.png"},b76c:function(t,e,n){"use strict";var i=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{id:"LongTextDialog",visible:t.show,"close-on-click-modal":!1,width:"70%"},on:{"update:visible":function(e){t.show=e}}},[e("template",{slot:"title"},[t._v("\n    "+t._s(t.title)+"\n    "),e("span",{staticClass:"text-info press-esc-to-close-tip"},[t._v(t._s(t.$t("Press ESC to close")))])]),t._v(" "),e("div",[t.showDownload&&t.fileName&&t.content?e("div",{staticClass:"download-link"},[e("el-link",{attrs:{type:"primary"},on:{click:t.download}},[t._v("\n        "+t._s(t.$t("Download as a text file"))+"\n        "),e("i",{staticClass:"fa fa-fw fa-download"})])],1):t._e(),t._v(" "),e("textarea",{attrs:{id:"longTextDialogContent"}})])],2)},r=[],o=(n("130f"),n("21a6")),a=n.n(o),s={name:"LongTextDialog",components:{},watch:{},methods:{update:function(t,e){var n=this;this.codeMirror&&this.codeMirror.setValue(""),this.content=t,this.fileName=(e||"dump")+".txt",this.show=!0,setImmediate((function(){if(!n.codeMirror){var t={mode:n.mode||"text"};n.codeMirror=n.T.initCodeMirror("longTextDialogContent",t),n.codeMirror.setOption("theme",n.T.getCodeMirrorThemeName()),n.T.setCodeMirrorReadOnly(n.codeMirror,!0)}n.codeMirror.setValue(n.content||""),n.codeMirror.refresh(),n.codeMirror.focus()}))},download:function(){var t=new Blob([this.content],{type:"text/plain"}),e=this.fileName;a.a.saveAs(t,e)}},computed:{},props:{title:String,mode:String,showDownload:Boolean},data:function(){return{show:!1,fileName:null,content:null,codeMirror:null}},beforeDestroy:function(){this.T.destoryCodeMirror(this.codeMirror)}},c=s,l=(n("68fc"),n("cb4e"),n("2877")),u=n("7b0b4"),d=Object(l["a"])(c,i,r,!1,null,"7f557796",null);"function"===typeof u["default"]&&Object(u["default"])(d);e["a"]=d.exports},b951:function(t,e,n){"use strict";n("b0c0");var i=function(){var t=this,e=t._self._c;return e("el-drawer",{attrs:{modal:!1,visible:t.show,direction:"rtl"},on:{"update:visible":function(e){t.show=e}}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("i",{staticClass:"fa fa-fw fa-cog"}),t._v(" "+t._s(t.$t("Code Editor setting"))+"\n  ")]),t._v(" "),e("div",{staticClass:"code-editor-setting"},[e("InfoBlock",{attrs:{type:"warning",title:t.$t("Setting of Code Editor only effect current browser")}}),t._v(" "),e("br"),t._v(" "),e("el-form",{ref:"form",attrs:{"label-width":"100px",model:t.form,rules:t.formRules}},[e("el-form-item",{attrs:{label:t.$t("Theme")}},[e("el-select",{model:{value:t.form.theme,callback:function(e){t.$set(t.form,"theme",e)},expression:"form.theme"}},t._l(t.C.CODE_MIRROR_THEME,(function(n){return e("el-option",{key:n.key,attrs:{label:t.$t(n.name),value:n.key}})})),1)],1),t._v(" "),e("el-form-item",{attrs:{label:t.$t("Font Size"),prop:"style.fontSize"}},[e("el-slider",{attrs:{min:12,max:36,step:1,"show-input":!0,"show-input-controls":!1,"show-tooltip":!1},model:{value:t.form.style.fontSize,callback:function(e){t.$set(t.form.style,"fontSize",t._n(e))},expression:"form.style.fontSize"}})],1),t._v(" "),e("el-form-item",{attrs:{label:t.$t("Line Height"),prop:"style.lineHeight"}},[e("el-slider",{attrs:{min:1,max:2,step:.1,"show-input":!0,"show-input-controls":!1,"show-tooltip":!1},model:{value:t.form.style.lineHeight,callback:function(e){t.$set(t.form.style,"lineHeight",t._n(e))},expression:"form.style.lineHeight"}})],1),t._v(" "),e("el-form-item",[e("div",{staticClass:"setup-right"},[e("el-button",{on:{click:t.resetDefault}},[t._v(t._s(t.$t("Reset to default")))])],1)])],1)],1)])},r=[],o=(n("130f"),{name:"CodeEditorSetting",components:{},watch:{form:{deep:!0,handler:function(t,e){var n=this,i=this.T.jsonCopy(this.form);this.$store.commit("updateCodeMirrorSettings",i),setImmediate((function(){n.codeMirror&&n.codeMirror.refresh()}))}}},methods:{open:function(){this.show=!0},resetDefault:function(){this.form=this.T.jsonCopy({theme:this.C.CODE_MIRROR_THEME_DEFAULT.key,style:this.$store.getters.DEFAULT_STATE.codeMirrorStyle})}},props:{codeMirror:Object},data:function(){var t=this.T.jsonCopy({theme:this.$store.getters.codeMirrorSettings.theme,style:{fontSize:parseInt(this.$store.getters.codeMirrorSettings.style.fontSize),lineHeight:this.$store.getters.codeMirrorSettings.style.lineHeight}});return{show:!1,form:t,formRules:{"style.fontSize":[{trigger:"change",message:this.$t("Please input font size"),required:!0},{trigger:"change",message:this.$t("Font size should be a integer between 12 and 36"),type:"integer",min:12,max:36}],"style.lineHeight":[{trigger:"change",message:this.$t("Please input line height"),required:!0},{trigger:"change",message:this.$t("Line height should be a number between 1 and 2"),type:"number",min:1,max:2}]}}}}),a=o,s=(n("5afa"),n("484b"),n("2877")),c=n("f9af"),l=Object(s["a"])(a,i,r,!1,null,"74fede1a",null);"function"===typeof c["default"]&&Object(c["default"])(l);e["a"]=l.exports},c5bf:function(t,e,n){},cb4e:function(t,e,n){"use strict";n("3aac")},d564:function(t,e,n){"use strict";n("8b57")},d612:function(t,e,n){},d9a5:function(t,e,n){"use strict";n("c5bf")},eee7:function(t,e,n){n("02ec");var i=n("23e7"),r=n("67b6");i({target:"String",proto:!0,name:"trimStart",forced:"".trimStart!==r},{trimStart:r})},efd8:function(t,e,n){"use strict";n.r(e);n("14d9"),n("b0c0"),n("99af");var i=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"fade-s"}},[e("split-pane",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.isLoaded,expression:"$store.state.isLoaded"}],ref:"vueSplitPane",attrs:{"min-percent":0,"default-percent":100,split:"horizontal"},on:{resize:t.resizeVueSplitPane}},[e("template",{slot:"paneL"},[e("el-container",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullScreenLoading,expression:"fullScreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-spinner":"el-icon-loading","element-loading-text":t.workerRunningTipTitle}},[e("el-header",{staticClass:"code-editor",staticStyle:{height:"unset !important"}},[e("div",{staticClass:"code-editor-action-left"},[e("code",{staticClass:"code-editor-action-title"},[e("i",{staticClass:"fa fa-file-code-o"}),t._v("\n              "+t._s(t.data.id)+"\n              "),e("el-tooltip",{attrs:{content:t.$t("Script Setup"),placement:"bottom",enterable:!1}},[e("el-button",{attrs:{type:"text"},on:{click:function(e){return e.stopPropagation(),t.$router.push({name:"script-setup",params:{id:t.data.id}})}}},[e("i",{staticClass:"fa fa-fw fa-wrench"})])],1)],1)]),t._v(" "),e("div",{staticClass:"code-editor-action-breaker hidden-lg-and-up"}),t._v(" "),e("div",{staticClass:"code-editor-action-right"},[e("el-form",{attrs:{inline:!0}},[e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.conflictStatus,expression:"conflictStatus"}]},["otherTab"===t.conflictStatus?e("span",{staticClass:"text-bad"},[t._v(t._s(t.$t("Script is under editing in other tab, please wait...")))]):"otherClient"===t.conflictStatus?e("span",{staticClass:"text-bad"},[t._v(t._s(t.$t("Script is under editing in other client, please wait...")))]):t._e()]),t._v(" "),e("el-form-item",[e("el-select",{staticStyle:{width:"150px"},attrs:{"popper-class":"code-font",size:"mini",filterable:"",placeholder:t.$t("Select Target")},model:{value:t.selectedItemId,callback:function(e){t.selectedItemId=e},expression:"selectedItemId"}},t._l(t.selectableItems,(function(n){return e("el-option",{key:n.id,attrs:{label:n.name,value:n.id}},["todo"===n.type?e("el-tag",{staticClass:"select-todo-tag",attrs:{size:"mini",type:t.C.TODO_TYPE_MAP.get(n.todoType).tagType}},[e("i",{staticClass:"fa fa-fw",class:t.C.TODO_TYPE_MAP.get(n.todoType).icon}),t._v("\n                      "+t._s(n.todoType)+"\n                    ")]):e("el-tag",{staticClass:"select-item-tag",attrs:{type:"info",size:"mini"}},[t._v(t._s(n.type))]),t._v("\n                    "+t._s(n.name)+"\n                  ")],1)})),1)],1),t._v(" "),t.conflictStatus?t._e():[e("el-form-item",{staticClass:"hidden-lg-and-up"},[e("el-tooltip",{attrs:{placement:"bottom",enterable:!1}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                      "+t._s(t.$t("Viewport are too narrow"))),e("br"),t._v("\n                      "+t._s(t.$t("Writing test cases to test your Func is recommended"))+"\n                    ")]),t._v(" "),e("el-tag",{staticStyle:{height:"29px"},attrs:{type:"info",size:"medium"}},[t._v(t._s(t.$t("Args")))])],1)],1),t._v(" "),e("el-form-item",{staticClass:"hidden-md-and-down"},[e("el-popover",{attrs:{placement:"bottom",trigger:"hover",width:"380",disabled:!t.isFuncSelected}},[e("div",[e("el-input",{staticClass:"code-editor-call-func-kwargs-json",attrs:{type:"textarea",resize:"none",autosize:{minRows:3,maxRows:15},clearable:!0,placeholder:t.$t("Arguments (JSON)")},model:{value:t.funcCallKwargsJSON,callback:function(e){t.funcCallKwargsJSON=e},expression:"funcCallKwargsJSON"}}),t._v(" "),t.isValidFuncCallKwargsJSON?t._e():e("InfoBlock",{attrs:{type:"error",title:t.$t("Invalid argument format")}}),t._v(" "),e("InfoBlock",{attrs:{type:"info",title:t.$t('Arguments should be inputed like {"arg": value}.')+"\n"+t.$t("Leave blank or {} when no argument")}}),t._v(" "),e("InfoBlock",{attrs:{type:"info",title:t.$t("Writing test cases to test your Func is recommended")}})],1),t._v(" "),e("el-input",{staticClass:"code-editor-call-func-kwargs-json",staticStyle:{width:"150px","text-overflow":"ellipsis"},attrs:{slot:"reference",size:"mini",readonly:!0,placeholder:t.$t("Arguments (JSON)"),value:t.funcCallKwargsShowValue,disabled:!t.isFuncSelected},slot:"reference"})],1)],1),t._v(" "),e("el-form-item",[e("el-tooltip",{attrs:{placement:"bottom",enterable:!1}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                      "+t._s(t.$t("Run selected Func"))),e("br"),t._v("\n                      "+t._s(t.$t("Shortcut"))+t._s(t.$t(":"))+" "),e("kbd",[t._v(t._s(t.T.getSuperKeyName()))]),t._v(" + "),e("kbd",[t._v("B")])]),t._v(" "),e("el-button",{directives:[{name:"prevent-re-click",rawName:"v-prevent-re-click"}],attrs:{type:"primary",plain:"",size:"mini",disabled:!(t.selectedItemId&&!t.workerRunning&&t.isFuncSelected)},on:{click:t.callFuncDraft}},[e("i",{staticClass:"fa fa-fw fa-play"}),t._v(" "+t._s(t.$t("Run"))+"\n                    ")])],1)],1),t._v(" "),t.isEditable?e("el-form-item",[e("el-button-group",[e("el-tooltip",{attrs:{placement:"bottom",enterable:!1}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                        "+t._s(t.$t("Save Script draft"))),e("br"),t._v("\n                        "+t._s(t.$t("Shortcut"))+t._s(t.$t(":"))+" "),e("kbd",[t._v(t._s(t.T.getSuperKeyName()))]),t._v(" + "),e("kbd",[t._v("S")])]),t._v(" "),e("el-button",{directives:[{name:"prevent-re-click",rawName:"v-prevent-re-click"}],attrs:{disabled:t.workerRunning,plain:"",size:"mini"},on:{click:function(e){return t.saveScript()}}},[e("i",{staticClass:"fa fa-fw fa-save"}),t._v(" "),e("span",{staticClass:"hidden-lg-and-down"},[t._v(t._s(t.$t("Save")))])])],1),t._v(" "),e("el-tooltip",{attrs:{placement:"bottom",enterable:!1}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                        "+t._s(t.$t("Show code diff"))+"\n                      ")]),t._v(" "),e("el-button",{attrs:{disabled:t.workerRunning,plain:"",size:"mini"},on:{click:function(e){return t.showDiff()}}},[e("i",{staticClass:"fa fa-fw fa-code"}),t._v(" "),e("span",{staticClass:"hidden-lg-and-down"},[t._v(t._s(t.$t("DIFF")))])])],1),t._v(" "),e("el-tooltip",{attrs:{placement:"bottom",enterable:!1}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                        "+t._s(t.$t("Save and publish Script"))),e("br")]),t._v(" "),e("el-button",{attrs:{disabled:t.workerRunning,plain:"",size:"mini"},on:{click:t.publishScript}},[e("i",{staticClass:"fa fa-fw fa-coffee"}),t._v(" "+t._s(t.$t("Publish"))+"\n                      ")])],1)],1)],1):t._e()],t._v(" "),e("el-form-item",[e("el-button-group",[!t.conflictStatus&&t.isEditable?[e("el-tooltip",{attrs:{content:t.$t("Recover code to latest published version"),placement:"bottom",enterable:!1}},[e("el-button",{attrs:{disabled:t.workerRunning,plain:"",size:"mini"},on:{click:t.resetScript}},[e("i",{staticClass:"fa fa-fw fa-history"})])],1)]:t._e(),t._v(" "),e("el-tooltip",{attrs:{content:t.$t("End editing"),placement:"bottom",enterable:!1}},[e("el-button",{attrs:{disabled:t.workerRunning,plain:"",size:"mini"},on:{click:t.endEdit}},[e("i",{staticClass:"fa fa-fw fa-sign-out"}),t._v(" "+t._s(t.$t("Exit")))])],1)],2)],1),t._v(" "),e("el-form-item",[e("el-button-group",[e("el-tooltip",{attrs:{content:t.$t("Code Editor setting"),placement:"bottom",enterable:!1}},[e("el-button",{attrs:{disabled:t.workerRunning,plain:"",size:"mini"},on:{click:function(e){return t.$refs.codeEditorSetting.open()}}},[e("i",{staticClass:"fa fa-fw fa-cog"})])],1)],1)],1)],2)],1),t._v(" "),t.isLockedByOther?e("InfoBlock",{attrs:{type:t.isEditable?"warning":"error",title:t.$t("This Script is locked by other user ({user})",{user:t.lockedByUser})}}):t._e(),t._v(" "),"builtin"===t.data.sset_origin?e("InfoBlock",{attrs:{type:"warning",title:t.$t("This is a built-in Script, code will be reset when the system restarts")}}):t._e()],1),t._v(" "),e("el-main",{style:t.$store.getters.codeMirrorSettings.style,attrs:{id:"editorContainer_CodeEditor"}},[e("textarea",{attrs:{id:"editor_CodeEditor"}})]),t._v(" "),e("FeatureNoticeDialog",{attrs:{featureKey:"codeEditor.monkeyPatch",description:t.$t("FeatureNotice_monkeyPatch"),icon:"fa-warning",image:t.img_noticeMonkeyPatch}}),t._v(" "),e("LongTextDialog",{ref:"longTextDialog",attrs:{title:t.$t("Diff between published and previously published"),mode:"diff"}}),t._v(" "),e("CodeEditorSetting",{ref:"codeEditorSetting",attrs:{codeMirror:t.codeMirror}})],1)],1),t._v(" "),e("template",{slot:"paneR"},[e("div",{staticClass:"code-editor-output"},[e("div",{staticClass:"code-editor-output-close"},[e("el-link",{attrs:{type:"info",underline:!0},on:{click:function(e){return e.stopPropagation(),t.clearHighlight()}}},[e("i",{staticClass:"fa fa-eraser"}),t._v(" "+t._s(t.$t("Clear highlighted")))]),t._v("\n          　\n          "),e("el-link",{attrs:{type:"info",underline:!0},on:{click:function(e){return e.stopPropagation(),t.clearScriptOutput()}}},[e("i",{staticClass:"fa fa-times"}),t._v(" "+t._s(t.$t("Close")))])],1),t._v(" "),e("el-tabs",{attrs:{"tab-position":"left",type:"border-card"}},[e("el-tab-pane",{ref:"codeEditorTextOutput",attrs:{label:"".concat(t.$t("Output")," ").concat(t.funcCallSeq>0?"#".concat(t.funcCallSeq):"")}},[e("pre",{domProps:{innerHTML:t._s(this.scriptOutputText||t.$t("Func exection result or log message will be shown here"))}})])],1)],1)])],2)],1)},r=[],o=n("6b75");function a(t){if(Array.isArray(t))return Object(o["a"])(t)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630");function s(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var c=n("06c5");n("d9e2");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t){return a(t)||s(t)||Object(c["a"])(t)||l()}var d=n("c7eb"),p=n("1da1"),f=(n("d81d"),n("498a"),n("a15b"),n("130f"),n("b64b"),n("25f0"),n("e9c4"),n("b680"),n("fb6a"),n("13d5"),n("4de4"),n("ac1f"),n("a1f0"),n("159b"),n("38cf"),n("eee7"),n("b951")),h=n("b76c"),m=n("bf68"),g=n("21a6"),b=n.n(g);const{replace:v}="",w=/[&<>'"]/g,S={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},_=t=>S[t],y=t=>v.call(t,w,_);var k=n("5a45"),C=n("b3ba"),I=n.n(C),T={name:"CodeEditor",components:{FeatureNoticeDialog:k["a"],CodeEditorSetting:f["a"],LongTextDialog:h["a"]},watch:{$route:{immediate:!0,handler:function(t,e){var n=this;return Object(p["a"])(Object(d["a"])().mark((function t(){return Object(d["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n.isNewLoaded=!0,t.next=3,n.loadData();case 3:case"end":return t.stop()}}),t)})))()}},isConflict:{immediate:!0,handler:function(t){this.T.setCodeMirrorReadOnly(this.codeMirror,t)}},splitPanePercent:function(t){this.resizeVueSplitPane(t)},codeMirrorTheme:function(t){this.codeMirror.setOption("theme",t)},selectedItemId:function(t){this.$store.commit("updateEditor_selectedItemId",t),this.highlightQuickSelectItem(),this.autoFillFuncCallKwargsJSON(t)},"$store.state.Editor_selectedItemId":function(t){this.selectedItemId!==t&&(this.selectedItemId=t)},"$store.state.shortcutAction":function(t){switch(t.action){case"codeEditor.save":this.saveScript();break;case"codeEditor.run":this.callFuncDraft();break}}},methods:{_refreshAside:function(){this.updateSelectableItems(),this.$store.commit("updateScriptListSyncTime")},_downloadEditingCodeDraft:function(t){var e=new Blob([t],{type:"text/plain"}),n="".concat(this.scriptId,".").concat(this.M().format("YYYYMMDD_HHmmss"),".py.DRAFT");return b.a.saveAs(e,n),n},_saveCodeDraft:function(t){var e=this;return Object(p["a"])(Object(d["a"])().mark((function n(){return Object(d["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.isSavingCodeDraft){n.next=5;break}return n.next=3,e.T.sleep(1e3);case 3:n.next=0;break;case 5:return e.isSavingCodeDraft=!0,null,n.prev=7,n.next=10,e._saveCodeDraftImpl(t);case 10:return n.abrupt("return",n.sent);case 13:n.prev=13,n.t0=n["catch"](7);case 15:return n.prev=15,e.isSavingCodeDraft=!1,n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[7,13,15,18]])})))()},_saveCodeDraftImpl:function(t){var e=this;return Object(p["a"])(Object(d["a"])().mark((function n(){var i,r,o,a;return Object(d["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t=t||{},e.isEditable){n.next=3;break}return n.abrupt("return");case 3:if(e.codeMirror){n.next=5;break}return n.abrupt("return");case 5:return i=e.prevCodeDraftMD5,r=e.codeMirror.getValue(),o=r.split("\n").map((function(t){return""===t.trim()?"":t})),r=o.join("\n"),n.next=11,e.T.callAPI("post","/api/v1/scripts/:id/do/modify",{params:{id:e.scriptId},body:{data:{codeDraft:r},prevCodeDraftMD5:i},alert:{okMessage:t.mute?null:e.$t("Script saved"),muteError:!0}});case 11:if(a=n.sent,a.ok){n.next=27;break}n.t0=a.reason,n.next="EBizRequestConflict.scriptDraftAlreadyChanged"===n.t0?16:22;break;case 16:return n.next=18,e.T.confirm("".concat(e.$t("Operating too frequently or Script is modified in other tab"),'\n                <br><span class="text-main">').concat(e.$t("Do you want to download current editing Script?"),"</span>"),"error");case 18:if(!n.sent){n.next=20;break}e._downloadEditingCodeDraft(r);case 20:return e.endEdit(),n.abrupt("break",25);case 22:return e.T.alert("".concat(e.$t("Saving Script failed"),'</span>\n                <br><span class="text-good">').concat(e.$t("Current editing Script has been downloaded"),"</span>")),e._downloadEditingCodeDraft(r),n.abrupt("break",25);case 25:n.next=30;break;case 27:e.data.codeDraft=r,e.prevCodeDraftMD5=a.data.codeDraftMD5,e._refreshAside();case 30:return n.abrupt("return",a);case 31:case"end":return n.stop()}}),n)})))()},loadData:function(t){var e=this;return Object(p["a"])(Object(d["a"])().mark((function n(){var i;return Object(d["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=t||{},t.codeField=t.codeField||"codeDraft",n.next=4,e.T.callAPI_getOne("/api/v1/scripts/do/list",e.scriptId,{query:{_withCode:!0,_withCodeDraft:!0}});case 4:if(i=n.sent,i.ok&&i.data){n.next=8;break}return e.$router.push({name:"intro"}),n.abrupt("return");case 8:e.data=i.data,e.prevCodeDraftMD5=i.data.codeDraftMD5,e.$store.commit("updateLoadStatus",!0),setImmediate((function(){if(e.codeMirror.setValue(""),e.codeMirror.setValue(e.data[t.codeField]||""),e.codeMirror.refresh(),e.codeMirror.focus(),!e.isConflict&&e.isEditable||e.T.setCodeMirrorReadOnly(e.codeMirror,!0),e.updateSelectableItems(),e.$store.state.Editor_selectedItemId)e.selectedItemId=e.$store.state.Editor_selectedItemId,e.highlightQuickSelectItem();else{var n=e.$store.state.Editor_scriptCursorMap[e.scriptId];e.T.jumpToCodeMirrorLine(e.codeMirror,n)}e.isReady=!0})),e.closeVueSplitPane();case 14:case"end":return n.stop()}}),n)})))()},saveScript:function(){var t=this;return Object(p["a"])(Object(d["a"])().mark((function e(){return Object(d["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isEditable){e.next=2;break}return e.abrupt("return");case 2:if(t.codeMirror){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,t._saveCodeDraft();case 6:case"end":return e.stop()}}),e)})))()},showDiff:function(){var t=this.data.title?" (".concat(this.data.title,")"):"",e="".concat(this.scriptId).concat(t),n=this.data.code||"",i=this.data.codeDraft||"",r=this.$t("Published Code"),o=this.$t("Saved Draft Code"),a=Object(m["createPatch"])(e,n,i,r,o),s=this.M().utcOffset(8).format("YYYYMMDD_HHmmss"),c="".concat(this.data.id,".diff.").concat(s);this.$refs.longTextDialog.update(a,c)},publishScript:function(){var t=this;return Object(p["a"])(Object(d["a"])().mark((function e(){var n,i;return Object(d["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isEditable){e.next=2;break}return e.abrupt("return");case 2:if(t.codeMirror){e.next=4;break}return e.abrupt("return");case 4:return t.updateHighlightLineConfig("selectedFuncLine",null),t.updateHighlightLineConfig("errorLine",null),e.next=8,t.T.confirm(t.$t("Are you sure you want to publish the Script?"));case 8:if(e.sent){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,t._saveCodeDraft({mute:!0});case 12:if(n=e.sent,n&&n.ok){e.next=15;break}return e.abrupt("return");case 15:return t.workerRunning=!0,t.workerRunningTipTitle=t.$t("Publishing Script, it will be finished in a few seconds. If the page is not responding for a long time, please try refreshing."),i=setTimeout((function(){t.fullScreenLoading=!0}),200),e.next=20,t.T.callAPI("post","/api/v1/scripts/:id/do/publish",{params:{id:t.scriptId},body:{wait:!1,data:{note:"Published by Code Editor"}},alert:{okMessage:t.$t("Script published, new Script is in effect immediately"),muteError:!0}});case 20:if(n=e.sent,clearTimeout(i),t.fullScreenLoading=!1,t.workerRunning=!1,n.ok){e.next=28;break}return t.outputResult("publish",t.scriptId,n),t.alertOnEScript(n,!0),e.abrupt("return");case 28:t._refreshAside(),t.data.code=t.data.codeDraft;case 30:case"end":return e.stop()}}),e)})))()},resetScript:function(){var t=this;return Object(p["a"])(Object(d["a"])().mark((function e(){return Object(d["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isEditable){e.next=2;break}return e.abrupt("return");case 2:if(t.codeMirror){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,t.T.confirm(t.$t("Are you sure you want to reset the Script?"));case 6:if(e.sent){e.next=8;break}return e.abrupt("return");case 8:return t.updateHighlightLineConfig("errorLine",null),e.next=11,t.loadData({codeField:"code"});case 11:t.T.notify(t.$t("Script has been reset to previous version"));case 12:case"end":return e.stop()}}),e)})))()},callFuncDraft:function(){var t=this;return Object(p["a"])(Object(d["a"])().mark((function e(){var n,i,r,o,a,s,c,l,u,p;return Object(d["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.codeMirror){e.next=2;break}return e.abrupt("return");case 2:if(t.updateHighlightLineConfig("selectedFuncLine",null),t.updateHighlightLineConfig("errorLine",null),!t.isEditable){e.next=10;break}return e.next=7,t._saveCodeDraft({mute:!0});case 7:if(n=e.sent,n&&n.ok){e.next=10;break}return e.abrupt("return");case 10:i=null,e.prev=11,i=JSON.parse(t.funcCallKwargsJSON||"{}"),e.next=18;break;case 15:return e.prev=15,e.t0=e["catch"](11),e.abrupt("return",t.T.alert("".concat(t.$t("Invalid argument format"),"<br>").concat(e.t0.toString())));case 18:return r=function(e){var n=t.$t("Func is running. If it is not responding for a long time, please try refreshing.");e>0&&(n=t.$t("Func is running. It will wait at most {seconds} for the result. If it is not responding for a long time, please try refreshing.",{seconds:t.$tc("seconds",e)})),t.workerRunningTipTitle=n},t.workerRunning=!0,t.countDownTimer&&(clearInterval(t.countDownTimer),t.countDownTimer=null),o=t.$store.getters.SYSTEM_INFO("_FUNC_TASK_DEBUG_TIMEOUT"),r(o),t.countDownTimer=setInterval((function(){o--,(o<=0||!t.workerRunning)&&clearInterval(t.countDownTimer),r(o)}),1e3),a=setTimeout((function(){t.fullScreenLoading=!0}),500),s=null,e.prev=26,e.next=29,t.T.callAPI("post","/api/v1/func-draft/:funcId",{params:{funcId:t.selectedItemId},body:{kwargs:i},alert:{muteError:!0},extraOptions:{noCountProcessing:!0}});case 29:s=e.sent,e.next=35;break;case 32:return e.prev=32,e.t1=e["catch"](26),e.abrupt("return",console.error(e.t1));case 35:return e.prev=35,clearTimeout(a),t.fullScreenLoading=!1,t.workerRunning=!1,e.finish(35);case 40:for(l in c=[],i)i.hasOwnProperty(l)&&(u=i[l],u=null===u?"None":!0===u?"True":!1===u?"False":JSON.stringify(u),c.push("".concat(l,"=").concat(u)));p=c.join(", "),t.outputResult("execute","".concat(t.selectedItemId,"(").concat(p,")"),s),s.ok&&setImmediate((function(){t.highlightQuickSelectItem()})),s.ok||"EScriptPreCheck"===s.reason||t.alertOnEScript(s);case 46:case"end":return e.stop()}}),e,null,[[11,15],[26,32,35,40]])})))()},clearHighlight:function(){this.updateHighlightLineConfig("selectedFuncLine",null),this.updateHighlightLineConfig("errorLine",null)},clearScriptOutput:function(){this.scriptOutput=[],this.clearHighlight(),this.resizeVueSplitPane(100)},outputResult:function(t,e,n){var i=this;if(n.ok||"EScriptPreCheck"===n.reason){this.funcCallSeq++;var r=null,o=null,a=null,s=null,c=null;if(n.data&&(n.ok&&(r=n.data.peakMemroyUsage,o=n.data.cost.toFixed(3)),a=n.data.result.logMessages,Array.isArray(a)&&(a=a.map((function(t){var e=t.split(" "),n='<span class="text-main">'.concat(e[0]," ").concat(e[1],"</span>"),i='<span class="text-good">'.concat(e[2],"</span>"),r=y(e.slice(3).join(" "));return[n,i,r].join(" ")})),a=a.join("\n")||null),n.ok))try{s=n.data.result.funcResult.repr||null,s=y(s)}catch(p){}if(n.detail){var l=n.detail.einfoTEXT.split("\n").reduce((function(t,e){return e.trim()?(t.push('<span class="code-editor-output-error-stack">'.concat(y(e),"</span>")),t):t}),[]);c=l.join("\n")}var d={seq:this.funcCallSeq,type:t,name:e,peakMemroyUsage:r,cost:o,logMessages:a,funcOutput:s,stackInfo:c};this.scriptOutput.push(d),this.openVueSplitPane(),setImmediate((function(){var t=document.getElementsByClassName("code-editor-output-seq"),e=t[t.length-1],n=i.$refs.codeEditorTextOutput.$el.parentElement,r=n.parentElement;n.scrollTo({left:0,top:e.offsetTop-r.scrollHeight+35}),n.scrollTo({left:0,top:n.scrollHeight,behavior:"smooth"})})),n.ok||setImmediate((function(){var t="".concat(i.scriptId),e=n.detail.traceInfo.stack,r=e.filter((function(e){if(e.isInScript&&e.filename===t)return!0})),o=r[r.length-1],a=u(n.detail.traceInfo.exceptionDump.matchAll(/^File \"(\w+)\", line (\d+)$/gm)).pop(),s=o?o.lineNumber-1:parseInt(a[2])-1,c="";try{c=n.detail.traceInfo.exceptionDump.split("\n").pop().split(":")[0].trim()}catch(d){return console.error(d)}var l='\n              <span class="error-info">\n                <i class="fa fa-fw fa-times-circle"></i>\n                <span>'.concat(c,"</span>\n              </span> ");i.updateHighlightLineConfig("errorLine",{line:s,scroll:1,marginType:"prev",textClass:"highlight-text",backgroundClass:"error-line-background highlight-code-line-blink",lineWidgetConfig:{type:"errorLine",innerHTML:l}})}))}},autoFillFuncCallKwargsJSON:function(t){this.funcCallKwargsJSON="",this.selectedItem&&"def"===this.selectedItem.type&&this.selectedItem.id===t&&(this.funcCallKwargsJSON=JSON.stringify(this.selectedItem.kwargs,null,2))},endEdit:function(t){t=t||{};var e={name:"code-viewer",params:{id:this.scriptId}};this.$router.push(e)},resizeVueSplitPane:function(t){t>=this.SPLIT_PANE_CLOSE_PERCENT?this.$refs.vueSplitPane.percent=t:(t>this.SPLIT_PANE_MAX_PERCENT?t=this.SPLIT_PANE_MAX_PERCENT:t<this.SPLIT_PANE_MIN_PERCENT&&(t=this.SPLIT_PANE_MIN_PERCENT),this.$refs.vueSplitPane.percent=t,this.debouncedUpdatePanePercent(this.$store,t))},updateSelectableItems:function(){this.selectableItems=this.common.getSelectableItems(this.data.codeDraft,this.scriptId)},openVueSplitPane:function(){this.$refs.vueSplitPane.percent=this.splitPanePercent},closeVueSplitPane:function(){this.$refs.vueSplitPane.percent=this.SPLIT_PANE_CLOSE_PERCENT},alertOnEScript:function(t,e){switch(t.reason){case"EScriptPreCheck":e?this.T.alert("".concat(this.$t("Script publishing failed. Please check your code"),"\n                <br>").concat(this.$t("Detail information is shown in the output box bellow"))):this.T.alert("".concat(this.$t("Script executing failed. Please check your code"),"\n                <br>").concat(this.$t("Detail information is shown in the output box bellow")));break;case"EAPITimeout":case"EFuncTimeout":e?this.T.alert("".concat(this.$t("Script publishing timeout, please make sure that no time-consuming code in global scope"),"\n                <br>").concat(this.$t("If this issue persists, please contact the administrator to report this issue"))):this.T.alert("".concat(this.$t("Waiting Func response timeout"),'\n                <span class="text-main">\n                  <br>').concat(this.$t("There is a {seconds} time limit when calling Funcs in Code Editor",{seconds:this.$tc("seconds",this.$store.getters.SYSTEM_INFO("_FUNC_TASK_DEBUG_TIMEOUT"))}),"\n                  <br>").concat(this.$t("It is not recommended for synchronous calling Funcs that response slowly"),"</small>\n                </span>"));break;case"EFuncFailed":e?this.T.alert("".concat(this.$t("Script publishing failed. Script executing module may crashed, please contact the administrator to report this issue"),"\n                <br>").concat(this.$t("Detail information is shown in the output box bellow"))):this.T.alert("".concat(this.$t("Script executing failed. Script executing module may crashed, please contact the administrator to report this issue"),"\n                <br>").concat(this.$t("Detail information is shown in the output box bellow")));break;case"EFuncResultParsingFailed":this.T.alert("".concat(this.$t("Func returned a value that can not been parsed as JSON. Please check your code"),"\n                <br>").concat(this.$t("In general, common used types are safe (e.g. list, dict, int, float, str, bool, None)."),"\n                <br>").concat(this.$t("Some math lib may return complicated values, like numpy.NaN. These values should be converted to common used types before returning")));break;case"EClientDuplicated":this.T.alert("".concat(this.$t("Duplicated names of Funcs decorated by @DFF.API(...)"),"\n                <br>").concat(this.$t("Please check the code and try again")));break}this.scriptOutput.length>0&&this.openVueSplitPane()},_clearLineHighlight:function(t){try{this.codeMirror.removeLineClass(t,"text"),this.codeMirror.removeLineClass(t,"background"),this.codeMirror.removeLineClass(t,"wrap");var e=this.codeMirror.lineInfo(t).widgets;Array.isArray(e)&&e.forEach((function(t){t.clear()}))}catch(n){}},_setLineHighlight:function(t){if(!this.codeMirror)return null;if(t=t||{},t.textClass&&this.codeMirror.addLineClass(t.line,"text",t.textClass),t.backgroundClass&&this.codeMirror.addLineClass(t.line,"background",t.backgroundClass),t.wrapClass&&this.codeMirror.addLineClass(t.line,"wrap",t.wrapClass),t.lineWidgetConfig){var e=t.lineWidgetConfig,n=null;switch(e.type){case"errorLine":n=document.createElement("div"),n.classList.add("error-line-text"),n.classList.add("highlight-text");var i=this.$store.getters.codeMirrorSettings.style;n.style.top="-".concat(parseInt(i.fontSize)*i.lineHeight,"px"),n.style.fontSize="".concat(i.fontSize),n.style.lineHeight=i.lineHeight,n.innerHTML=e.innerHTML;break}n&&this.codeMirror.addLineWidget(t.line,n)}return this.T.jumpToCodeMirrorLine(this.codeMirror,t.line),this.codeMirror.lineInfo(t.line)},updateHighlightLineConfig:function(t,e){var n=this.T.jsonCopy(this.$store.state.codeEditor_highlightedLineConfigMap)||{};if(null===e?n[this.scriptId]&&delete n[this.scriptId][t]:(n[this.scriptId]||(n[this.scriptId]={}),n[this.scriptId][t]=e),this.codeMirror){for(var i in this.highlightedLineInfoMap)if(this.highlightedLineInfoMap.hasOwnProperty(i)){var r=this.highlightedLineInfoMap[i];for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];this._clearLineHighlight(a.handle.lineNo())}}var s={},c=n[this.scriptId]||{};for(var l in c)if(c.hasOwnProperty(l)){var u=c[l],d=this._setLineHighlight(u);d&&(s[this.scriptId]||(s[this.scriptId]={}),s[this.scriptId][l]=d)}this.highlightedLineInfoMap=s,this.$store.commit("updateCodeEditor_highlightedLineConfigMap",n)}},highlightQuickSelectItem:function(){this.$store.state.isLoaded&&this.codeMirror&&this.selectedItem&&(this.updateHighlightLineConfig("selectedFuncLine",null),this.updateHighlightLineConfig("selectedFuncLine",{line:this.selectedItem.line,marginType:"next",textClass:"highlight-text",backgroundClass:"current-func-background highlight-code-line-blink"}))}},computed:{SPLIT_PANE_MAX_PERCENT:function(){return 80},SPLIT_PANE_MIN_PERCENT:function(){return 30},SPLIT_PANE_CLOSE_PERCENT:function(){return 100},TEXT_OUTPUT_LIMIT:function(){return 500},codeMirrorTheme:function(){return this.T.getCodeMirrorThemeName()},scriptId:function(){return this.T.isNothing(this.data)?this.$route.params.id:this.data.id},scriptSetId:function(){return this.scriptId.split("__")[0]},conflictStatus:function(){return this.$store.getters.getConflictStatus(this.$route)},funcCallKwargsShowValue:function(){try{return JSON.stringify(JSON.parse(this.funcCallKwargsJSON))}catch(t){return this.funcCallKwargsJSON}},lockedByUserId:function(){return this.data.sset_lockedByUserId||this.data.lockedByUserId},lockedByUser:function(){return this.data.sset_lockedByUserId?"".concat(this.data.sset_lockedByUserName||this.data.sset_lockedByUsername):this.data.lockedByUserId?"".concat(this.data.lockedByUserName||this.data.lockedByUsername):void 0},isLockedByMe:function(){return this.lockedByUserId===this.$store.getters.userId},isLockedByOther:function(){return this.lockedByUserId&&!this.isLockedByMe},isEditable:function(){return!!this.$store.getters.isAdmin||!this.isLockedByOther},splitPanePercent:function(){return this.$store.state.codeEditor_splitPanePercent||this.$store.getters.DEFAULT_STATE.codeEditor_splitPanePercent},codeLines:function(){return(this.data.code||"").split("\n").length},codeDraftLines:function(){return(this.data.codeDraft||"").split("\n").length},scriptOutputText:function(){var t=this,e=[];this.scriptOutput.forEach((function(n){var i='<span class="code-editor-output-info">#<span class="code-editor-output-seq">'.concat(n.seq,"</span> ").concat("-".repeat(20),"</span>"),r="";switch(n.type){case"publish":r=t.$t("Publish Script")+t.$t(":");break;case"execute":r=t.$t("Executed Func")+t.$t(":");break}var o='<span class="code-editor-output-info">'.concat(r," ").concat(n.name,"</span>"),a="";n.peakMemroyUsage&&(a='<span class="code-editor-output-info">'.concat(t.$t("Peak Memory Allocated")).concat(t.$t(":")," ").concat(t.T.byteSizeHuman(n.peakMemroyUsage),"</span>"));var s="";n.cost&&(s='<span class="code-editor-output-info">'.concat(t.$t("Run Time")).concat(t.$t(":")," ").concat(t.$tc("seconds",n.cost),"</span>"),n.cost>3&&(s+='<br>&#12288;<span class="text-watch">'.concat(t.$t("It took too much time for running (more than 3s), may not be suitable for synchronous calling scenario"),"</span>")));var c=n.logMessages,l=n.funcOutput,u=null;l&&(u='<span class="code-editor-output-info">'.concat(t.$t("Func Return Value (repr)")).concat(t.$t(":"),"</span>"));var d=n.stackInfo,p=null;d&&(p='<span class="code-editor-output-info">'.concat(t.$t("Stack")).concat(t.$t(":"),"</span>"));var f=[i,o];c&&f.push("",c),u&&f.push("",u,l),(s||a)&&(f.push(""),a&&f.push(a),s&&f.push(s)),p&&f.push("",p,d),f=f.filter((function(t){return"string"===typeof t})).join("\n").trimStart(),e.push(f)}));var n=e.join("\n\n"),i=n.split("\n");return i.length>this.TEXT_OUTPUT_LIMIT&&(n=i.slice(-1*this.TEXT_OUTPUT_LIMIT).join("\n")),n},isValidFuncCallKwargsJSON:function(){if(""===this.funcCallKwargsJSON.trim())return!0;if("{"!==this.funcCallKwargsJSON.trim()[0])return!1;try{JSON.parse(this.funcCallKwargsJSON)}catch(t){return!1}return!0},selectedItem:function(){if(!this.selectedItemId)return null;for(var t=0;t<this.selectableItems.length;t++){var e=this.selectableItems[t];if(e.id===this.selectedItemId)return e}},isFuncSelected:function(){return!!this.selectedItem&&"def"===this.selectedItem.type}},props:{},data:function(){return{isReady:!1,isNewLoaded:!0,codeMirror:null,highlightedLineInfoMap:{},currentErrorLineInfo:null,data:{},scriptSet:{},selectableItems:[],selectedItemId:"",funcCallKwargsJSON:"",funcCallSeq:0,countDownTimer:null,fullScreenLoading:!1,workerRunning:!1,workerRunningTipTitle:"",scriptOutput:[],prevCodeDraftMD5:null,isSavingCodeDraft:!1,img_noticeMonkeyPatch:I.a,showEditorSetting:!1}},created:function(){this.debouncedUpdatePanePercent=this.T.debounce((function(t,e){t.commit("updateCodeEditor_splitPanePercent",e)}),100)},mounted:function(){var t=this;setImmediate((function(){if(t.codeMirror=t.T.initCodeMirror("editor_CodeEditor"),t.codeMirror.setOption("theme",t.codeMirrorTheme),t.codeMirror.on("cursorActivity",(function(){if(t.isReady){var e={scriptId:t.scriptId,cursor:t.codeMirror.getCursor()};t.$store.commit("updateEditor_scriptCursorMap",e)}})),t.isEditable){var e=function(e){return t.T.debounce((function(n,i){if(e===t.scriptId&&t.isEditable&&t.codeMirror)if(t.isNewLoaded)t.isNewLoaded=!1;else{var r=t.codeMirror.getValue();if(r.trim()){var o=t.T.getDiffInfo(t.data.codeDraft,r),a=Math.max(o.addedCount,o.removedCount);a>30||a/o.srcTotalCount>.3||t._saveCodeDraft({mute:!0})}}}),1e3)};t.codeMirror.on("change",e(t.scriptId))}}))},beforeDestroy:function(){this.T.destoryCodeMirror(this.codeMirror)},beforeRouteLeave:function(t,e,n){var i=this;return Object(p["a"])(Object(d["a"])().mark((function t(){var e;return Object(d["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i.updateHighlightLineConfig("selectedFuncLine",null),i.updateHighlightLineConfig("errorLine",null),i.isEditable){t.next=4;break}return t.abrupt("return",n());case 4:if(i.codeMirror){t.next=6;break}return t.abrupt("return",n());case 6:if(i.$store.getters.isSignedIn){t.next=8;break}return t.abrupt("return",n());case 8:if(!i.T.isNothing(i.data)){t.next=10;break}return t.abrupt("return",n());case 10:return t.next=12,i._saveCodeDraft({mute:!0});case 12:if(e=t.sent,!e||!e.ok){t.next=15;break}return t.abrupt("return",n());case 15:case"end":return t.stop()}}),t)})))()}},x=T,E=(n("d564"),n("d9a5"),n("2877")),$=n("9667"),M=n("14e96"),O=Object(E["a"])(x,i,r,!1,null,"60138d18",null);"function"===typeof $["default"]&&Object($["default"])(O),"function"===typeof M["default"]&&Object(M["default"])(O);e["default"]=O.exports},f9af:function(t,e,n){"use strict";var i=n("7abf"),r=n.n(i);e["default"]=r.a}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-537f8175"],{"0154":function(e,t,a){"use strict";var r=a("cdae"),i=a.n(r);t["default"]=i.a},"13d2e":function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-CN":{"Root":"根目录","File Service disabled":"文件服务已禁用","File Service enabled":"文件服务已启用","File Service deleted":"文件服务已删除","No File Service has ever been added":"从未添加过任何文件服务","Are you sure you want to disable the File Service?":"是否确认禁用此文件服务？","Are you sure you want to delete the File Service?":"是否确认删除此文件服务？","Expose folders in the Resource as File Services to allow external systems to access files directly":"将资源目录下的文件夹创建为文件服务，即可在系统外部直接访问文件"}}'),delete e.options._Ctor}},"1bb1":function(e,t,a){"use strict";a("de02")},"3a6b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"fade"}},[t("el-container",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.isLoaded,expression:"$store.state.isLoaded"}],attrs:{direction:"vertical"}},[t("el-header",{attrs:{height:"60px"}},[t("div",{staticClass:"common-page-header"},[t("h1",[e._v(e._s(e.$t("File Service")))]),e._v(" "),t("div",{staticClass:"header-control"},[t("FuzzySearchInput",{attrs:{dataFilter:e.dataFilter}}),e._v(" "),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.openSetup(null,"add")}}},[t("i",{staticClass:"fa fa-fw fa-plus"}),e._v("\n            "+e._s(e.$t("New"))+"\n          ")])],1)])]),e._v(" "),t("el-main",{staticClass:"common-table-container"},[e.T.isNothing(e.data)?t("div",{staticClass:"no-data-area"},[e.T.isPageFiltered()?t("h1",{staticClass:"no-data-title"},[t("i",{staticClass:"fa fa-fw fa-search"}),e._v(e._s(e.$t("No matched data found")))]):t("h1",{staticClass:"no-data-title"},[t("i",{staticClass:"fa fa-fw fa-info-circle"}),e._v(e._s(e.$t("No File Service has ever been added")))]),e._v(" "),t("p",{staticClass:"no-data-tip"},[e._v("\n          "+e._s(e.$t("Expose folders in the Resource as File Services to allow external systems to access files directly"))+"\n        ")])]):t("el-table",{staticClass:"common-table",attrs:{height:"100%",data:e.data,"row-class-name":e.T.getHighlightRowCSS}},[t("el-table-column",{attrs:{label:e.$t("Root")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("code",{staticClass:"file-service-title"},[e._v(e._s(a.row.root))]),e._v(" "),t("div",[t("span",{staticClass:"text-info"},[e._v("ID")]),e._v("\n               "),t("code",{staticClass:"text-main"},[e._v(e._s(a.row.id))]),e._v(" "),t("CopyButton",{attrs:{content:a.row.id}}),e._v(" "),a.row.note?[t("br"),e._v(" "),t("span",{staticClass:"text-info"},[e._v("　"+e._s(e.$t("Note"))+e._s(e.$t(":")))]),e._v(" "),t("span",[e._v(e._s(a.row.note))])]:e._e()],2)]}}])}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("Status"),width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.isDisabled?t("span",{staticClass:"text-bad"},[e._v(e._s(e.$t("Disabled")))]):t("span",{staticClass:"text-good"},[e._v(e._s(e.$t("Enabled")))])]}}])}),e._v(" "),t("el-table-column",{attrs:{align:"right",width:"260"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{attrs:{href:a.row.openURL,target:"_blank"}},[e._v(e._s(e.$t("Open")))]),e._v(" "),a.row.isDisabled?t("el-link",{directives:[{name:"prevent-re-click",rawName:"v-prevent-re-click"}],on:{click:function(t){return e.quickSubmitData(a.row,"enable")}}},[e._v(e._s(e.$t("Enable")))]):t("el-link",{on:{click:function(t){return e.quickSubmitData(a.row,"disable")}}},[e._v(e._s(e.$t("Disable")))]),e._v(" "),t("el-link",{on:{click:function(t){return e.openSetup(a.row,"setup")}}},[e._v(e._s(e.$t("Setup")))]),e._v(" "),t("el-link",{on:{click:function(t){return e.quickSubmitData(a.row,"delete")}}},[e._v(e._s(e.$t("Delete")))])]}}])})],1)],1),e._v(" "),t("Pager",{attrs:{pageInfo:e.pageInfo}}),e._v(" "),t("FileServiceSetup",{ref:"setup"})],1)],1)},i=[],s=a("c7eb"),n=a("1da1"),o=(a("d3b7"),a("159b"),a("130f"),function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{id:"ScriptSetSetup",visible:e.show,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"750px"},on:{"update:visible":function(t){e.show=t}}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.pageTitle)+" "),t("code",{staticClass:"text-main"},[e._v(e._s(e.data.root))])]),e._v(" "),t("el-container",{attrs:{direction:"vertical"}},[t("el-main",[t("div",{staticClass:"setup-form"},[t("el-form",{ref:"form",attrs:{"label-width":"135px",model:e.form,rules:e.formRules}},["add"===e.pageMode?t("el-form-item",{attrs:{label:e.$t("Customize ID"),prop:"useCustomId"}},[t("el-switch",{model:{value:e.useCustomId,callback:function(t){e.useCustomId=t},expression:"useCustomId"}}),e._v(" "),t("span",{staticClass:"text-main float-right"},[e._v("\n              "+e._s(e.$t("URL Preview"))+e._s(e.$t(":"))+"\n              "),t("code",[e._v(e._s("/api/v1/fs/".concat(e.useCustomId?e.form.id:e.$t("randomIDString"))))])])],1):e._e(),e._v(" "),"add"===e.pageMode?t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.useCustomId,expression:"useCustomId"}],attrs:{label:"ID",prop:"id"}},[t("el-input",{attrs:{maxlength:"60"},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}}),e._v(" "),t("InfoBlock",{attrs:{title:e.$t("ID is used in the access URL")}})],1):e._e(),e._v(" "),t("el-form-item",{attrs:{label:e.$t("Root"),prop:"root"}},[t("el-cascader",{ref:"rootCascader",attrs:{placeholder:"--",separator:"",props:e.rootCascaderProps},model:{value:e.form.root,callback:function(t){e.$set(e.form,"root",t)},expression:"form.root"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("Note")}},[t("el-input",{attrs:{placeholder:e.$t("Optional"),type:"textarea",resize:"none",autosize:{minRows:2},maxlength:"5000"},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1),e._v(" "),t("el-form-item",{staticClass:"setup-footer"},["setup"===e.pageMode?t("el-button",{staticClass:"danger-button float-left",on:{click:e.deleteData}},[e._v(e._s(e.$t("Delete")))]):e._e(),e._v(" "),t("el-button",{directives:[{name:"prevent-re-click",rawName:"v-prevent-re-click"}],attrs:{type:"primary"},on:{click:e.submitData}},[e._v(e._s(e.$t("Save")))])],1)],1)],1)])],1)],2)}),c=[],l=(a("d9e2"),a("99af"),a("d81d"),a("b0c0"),a("b64b"),a("ac1f"),a("8a79"),a("466d"),{name:"FileServiceSetup",components:{},watch:{show:function(e){e||this.$root.$emit("reload.fileServiceList")},useCustomId:function(e){this.form.id=e?"".concat(this.ID_PREFIX,"my-file-service"):null}},methods:{loadData:function(e){var t=this;return Object(n["a"])(Object(s["a"])().mark((function a(){var r,i;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e){a.next=6;break}t.pageMode="add",t.T.jsonClear(t.form),t.data={},a.next=17;break;case 6:return t.pageMode="setup",t.data.id=e,a.next=10,t.T.callAPI_getOne("/api/v1/file-services/do/list",t.data.id);case 10:if(r=a.sent,r&&r.ok){a.next=13;break}return a.abrupt("return");case 13:t.data=r.data,i={},Object.keys(t.form).forEach((function(e){return i[e]=t.data[e]})),t.form=i;case 17:t.show=!0,setImmediate((function(){t.$refs.rootCascader.presentText=t.data.root}));case 19:case"end":return a.stop()}}),a)})))()},submitData:function(){var e=this;return Object(n["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.form.validate();case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t["catch"](0),t.abrupt("return",console.error(t.t0));case 8:t.t1=e.pageMode,t.next="add"===t.t1?11:"setup"===t.t1?14:17;break;case 11:return t.next=13,e.addData();case 13:return t.abrupt("return",t.sent);case 14:return t.next=16,e.modifyData();case 16:return t.abrupt("return",t.sent);case 17:case"end":return t.stop()}}),t,null,[[0,5]])})))()},addData:function(){var e=this;return Object(n["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.T.callAPI("post","/api/v1/file-services/do/add",{body:{data:e.T.jsonCopy(e.form)},alert:{okMessage:e.$t("File Service created")}});case 2:if(a=t.sent,a&&a.ok){t.next=5;break}return t.abrupt("return");case 5:e.$store.commit("updateHighlightedTableDataId",a.data.id),e.show=!1;case 7:case"end":return t.stop()}}),t)})))()},modifyData:function(){var e=this;return Object(n["a"])(Object(s["a"])().mark((function t(){var a,r;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.T.jsonCopy(e.form),delete a.id,t.next=4,e.T.callAPI("post","/api/v1/file-services/:id/do/modify",{params:{id:e.data.id},body:{data:a},alert:{okMessage:e.$t("File Service saved")}});case 4:if(r=t.sent,r&&r.ok){t.next=7;break}return t.abrupt("return");case 7:e.$store.commit("updateHighlightedTableDataId",r.data.id),e.show=!1;case 9:case"end":return t.stop()}}),t)})))()},deleteData:function(){var e=this;return Object(n["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.T.confirm(e.$t("Are you sure you want to delete the File Service?"));case 2:if(t.sent){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,e.T.callAPI("/api/v1/file-services/:id/do/delete",{params:{id:e.data.id},alert:{okMessage:e.$t("File Service deleted")}});case 6:if(a=t.sent,a&&a.ok){t.next=9;break}return t.abrupt("return");case 9:e.show=!1;case 10:case"end":return t.stop()}}),t)})))()}},computed:{ID_PREFIX:function(){return"fsvc-"},pageTitle:function(){var e={setup:this.$t("Setup File Service"),add:this.$t("Add File Service")};return e[this.pageMode]}},props:{},data:function(){var e=this;return{show:!1,pageMode:null,data:{},useCustomId:!1,form:{id:null,root:null,note:null},formRules:{id:[{trigger:"change",validator:function(t,a,r){if(e.T.notNothing(a)){if(0!==a.indexOf(e.ID_PREFIX)||a===e.ID_PREFIX)return r(new Error(e.$t('ID must starts with "{prefix}"',{prefix:e.ID_PREFIX})));if(!a.match(/^[0-9a-zA-Z\.\-\_]+$/g))return r(new Error(e.$t("Only numbers, alphabets, dot(.), underscore(_) and hyphen(-) are allowed")))}return r()}}],root:[{trigger:"blur",message:this.$t("Please select root"),required:!0}]},rootCascaderProps:{expandTrigger:"hover",emitPath:!1,multiple:!1,checkStrictly:!0,lazy:!0,lazyLoad:function(){var t=Object(n["a"])(Object(s["a"])().mark((function t(a,r){var i,n,o;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.T.callAPI_get("/api/v1/resources/do/list",{query:{folder:a.value,type:"folder"}});case 2:if(i=t.sent,i&&i.ok){t.next=5;break}return t.abrupt("return");case 5:n=a.value||"",n&&!e.T.endsWith(n,"/")&&(n+="/"),o=i.data.map((function(e){return{label:"".concat(e.name,"/"),value:"".concat(n).concat(e.name,"/")}})),r(o);case 9:case"end":return t.stop()}}),t)})));function a(e,a){return t.apply(this,arguments)}return a}()}}}}),u=l,d=a("2877"),f=a("0154"),p=a("ed1e"),v=a("cfaa"),b=a("58f1"),h=Object(d["a"])(u,o,c,!1,null,"ddb73ba4",null);"function"===typeof f["default"]&&Object(f["default"])(h),"function"===typeof p["default"]&&Object(p["default"])(h),"function"===typeof v["default"]&&Object(v["default"])(h),"function"===typeof b["default"]&&Object(b["default"])(h);var m=h.exports,_={name:"FileServiceList",components:{FileServiceSetup:m},watch:{$route:{immediate:!0,handler:function(e,t){var a=this;return Object(n["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.loadData();case 2:case"end":return e.stop()}}),e)})))()}},"$store.state.isLoaded":function(e){var t=this;e&&setImmediate((function(){return t.T.autoScrollTable()}))}},methods:{loadData:function(){var e=this;return Object(n["a"])(Object(s["a"])().mark((function t(){var a,r;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.dataFilter=e.T.createListQuery(),t.next=3,e.T.callAPI_get("/api/v1/file-services/do/list",{query:a});case 3:if(r=t.sent,r&&r.ok){t.next=6;break}return t.abrupt("return");case 6:r.data.forEach((function(t){t.openURL=e.T.formatURL("/api/v1/fs/:id/",{baseURL:!0,params:{id:t.id}})})),e.data=r.data,e.pageInfo=r.pageInfo,e.$store.commit("updateLoadStatus",!0);case 10:case"end":return t.stop()}}),t)})))()},quickSubmitData:function(e,t){var a=this;return Object(n["a"])(Object(s["a"])().mark((function r(){var i;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:r.t0=t,r.next="disable"===r.t0?3:"delete"===r.t0?8:13;break;case 3:return r.next=5,a.T.confirm(a.$t("Are you sure you want to disable the File Service?"));case 5:if(r.sent){r.next=7;break}return r.abrupt("return");case 7:return r.abrupt("break",13);case 8:return r.next=10,a.T.confirm(a.$t("Are you sure you want to delete the File Service?"));case 10:if(r.sent){r.next=12;break}return r.abrupt("return");case 12:return r.abrupt("break",13);case 13:i=null,r.t1=t,r.next="disable"===r.t1?17:"enable"===r.t1?21:"delete"===r.t1?25:29;break;case 17:return r.next=19,a.T.callAPI("post","/api/v1/file-services/:id/do/modify",{params:{id:e.id},body:{data:{isDisabled:!0}},alert:{okMessage:a.$t("File Service disabled")}});case 19:return i=r.sent,r.abrupt("break",29);case 21:return r.next=23,a.T.callAPI("post","/api/v1/file-services/:id/do/modify",{params:{id:e.id},body:{data:{isDisabled:!1}},alert:{okMessage:a.$t("File Service enabled")}});case 23:return i=r.sent,r.abrupt("break",29);case 25:return r.next=27,a.T.callAPI("/api/v1/file-services/:id/do/delete",{params:{id:e.id},alert:{okMessage:a.$t("File Service deleted")}});case 27:return i=r.sent,r.abrupt("break",29);case 29:if(i&&i.ok){r.next=31;break}return r.abrupt("return");case 31:return a.$store.commit("updateHighlightedTableDataId",e.id),r.next=34,a.loadData();case 34:case"end":return r.stop()}}),r)})))()},openSetup:function(e,t){this.T.packRouteQuery();switch(t){case"add":this.$refs.setup.loadData();break;case"setup":this.$store.commit("updateHighlightedTableDataId",e.id),this.$refs.setup.loadData(e.id);break}}},computed:{},props:{},data:function(){var e=this.T.createPageInfo(),t=this.T.createListQuery();return{data:[],pageInfo:e,dataFilter:{_fuzzySearch:t._fuzzySearch}}},created:function(){var e=this;this.$root.$on("reload.fileServiceList",(function(){return e.loadData()}))},destroyed:function(){this.$root.$off("reload.fileServiceList")}},w=_,S=(a("1bb1"),a("cc07")),x=a("cceb"),y=a("e6dc"),k=Object(d["a"])(w,r,i,!1,null,"f8f5245e",null);"function"===typeof S["default"]&&Object(S["default"])(k),"function"===typeof x["default"]&&Object(x["default"])(k),"function"===typeof y["default"]&&Object(y["default"])(k);t["default"]=k.exports},5480:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-TW":{"Add File Service":"新增檔案服務","Are you sure you want to delete the File Service?":"是否確認刪除此檔案服務？","Customize ID":"定製 ID","File Service created":"檔案服務已建立","File Service deleted":"檔案服務已刪除","File Service saved":"檔案服務已儲存","ID is used in the access URL":"此 ID 用於生成訪問時的 URL","ID must starts with \\"{prefix}\\"":"ID 必須以\\"{prefix}\\"開頭","Note":"備註","Only numbers, alphabets, dot(.), underscore(_) and hyphen(-) are allowed":"只能輸入數字、英文、點（.）、下劃線（_）以及連字元（-）","Please select root":"請選擇根目錄","Root":"根目錄","Setup File Service":"配置檔案服務","URL Preview":"URL預覽","randomIDString":"fsvc-{隨機 ID}"}}'),delete e.options._Ctor}},"58f1":function(e,t,a){"use strict";var r=a("5480"),i=a.n(r);t["default"]=i.a},"8a79":function(e,t,a){"use strict";var r=a("23e7"),i=a("e330"),s=a("06cf").f,n=a("50c4"),o=a("577e"),c=a("5a34"),l=a("1d80"),u=a("ab13"),d=a("c430"),f=i("".endsWith),p=i("".slice),v=Math.min,b=u("endsWith"),h=!d&&!b&&!!function(){var e=s(String.prototype,"endsWith");return e&&!e.writable}();r({target:"String",proto:!0,forced:!h&&!b},{endsWith:function(e){var t=o(l(this));c(e);var a=arguments.length>1?arguments[1]:void 0,r=t.length,i=void 0===a?r:v(n(a),r),s=o(e);return f?f(t,s,i):p(t,i-s.length,i)===s}})},"9c65":function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-CN":{"randomIDString":"fsvc-{随机 ID}","Add File Service":"添加文件服务","Setup File Service":"配置文件服务","Customize ID":"定制 ID","Root":"根目录","Note":"备注","URL Preview":"URL预览","ID is used in the access URL":"此 ID 用于生成访问时的 URL","ID must starts with \\"{prefix}\\"":"ID 必须以\\"{prefix}\\"开头","Only numbers, alphabets, dot(.), underscore(_) and hyphen(-) are allowed":"只能输入数字、英文、点（.）、下划线（_）以及连字符（-）","Please select root":"请选择根目录","File Service created":"文件服务已创建","File Service saved":"文件服务已保存","File Service deleted":"文件服务已删除","Are you sure you want to delete the File Service?":"是否确认删除此文件服务？"}}'),delete e.options._Ctor}},cc07:function(e,t,a){"use strict";var r=a("13d2e"),i=a.n(r);t["default"]=i.a},cceb:function(e,t,a){"use strict";var r=a("fe15"),i=a.n(r);t["default"]=i.a},cdae:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"en":{"randomIDString":"fsvc-{Random ID}"}}'),delete e.options._Ctor}},cfaa:function(e,t,a){"use strict";var r=a("f233"),i=a.n(r);t["default"]=i.a},de02:function(e,t,a){},e6dc:function(e,t,a){"use strict";var r=a("f826"),i=a.n(r);t["default"]=i.a},ed1e:function(e,t,a){"use strict";var r=a("9c65"),i=a.n(r);t["default"]=i.a},f233:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-HK":{"Add File Service":"添加文件服務","Are you sure you want to delete the File Service?":"是否確認刪除此文件服務？","Customize ID":"定製 ID","File Service created":"文件服務已創建","File Service deleted":"文件服務已刪除","File Service saved":"文件服務已保存","ID is used in the access URL":"此 ID 用於生成訪問時的 URL","ID must starts with \\"{prefix}\\"":"ID 必須以\\"{prefix}\\"開頭","Note":"備註","Only numbers, alphabets, dot(.), underscore(_) and hyphen(-) are allowed":"只能輸入數字、英文、點（.）、下劃線（_）以及連字符（-）","Please select root":"請選擇根目錄","Root":"根目錄","Setup File Service":"配置文件服務","URL Preview":"URL預覽","randomIDString":"fsvc-{隨機 ID}"}}'),delete e.options._Ctor}},f826:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-TW":{"Are you sure you want to delete the File Service?":"是否確認刪除此檔案服務？","Are you sure you want to disable the File Service?":"是否確認禁用此檔案服務？","Expose folders in the Resource as File Services to allow external systems to access files directly":"將資源目錄下的資料夾建立為檔案服務，即可在系統外部直接訪問檔案","File Service deleted":"檔案服務已刪除","File Service disabled":"檔案服務已禁用","File Service enabled":"檔案服務已啟用","No File Service has ever been added":"從未新增過任何檔案服務","Root":"根目錄"}}'),delete e.options._Ctor}},fe15:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-HK":{"Are you sure you want to delete the File Service?":"是否確認刪除此文件服務？","Are you sure you want to disable the File Service?":"是否確認禁用此文件服務？","Expose folders in the Resource as File Services to allow external systems to access files directly":"將資源目錄下的文件夾創建為文件服務，即可在系統外部直接訪問文件","File Service deleted":"文件服務已刪除","File Service disabled":"文件服務已禁用","File Service enabled":"文件服務已啓用","No File Service has ever been added":"從未添加過任何文件服務","Root":"根目錄"}}'),delete e.options._Ctor}}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8f0d6640"],{"1c11":function(t,e,a){"use strict";a.r(e);a("99af"),a("b0c0");var o=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"fade"}},[e("el-container",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.isLoaded,expression:"$store.state.isLoaded"}],attrs:{direction:"vertical"}},[e("el-header",{attrs:{height:"60px"}},[e("div",{staticClass:"common-page-header"},[e("h1",[t._v(t._s(t.$t("Script Set Import History")))]),t._v(" "),e("div",{staticClass:"header-control"})])]),t._v(" "),e("el-main",[t.T.isNothing(t.data)?e("div",{staticClass:"no-data-area"},[t.T.isPageFiltered()?e("h1",{staticClass:"no-data-title"},[e("i",{staticClass:"fa fa-fw fa-search"}),t._v(t._s(t.$t("No matched data found")))]):e("h1",{staticClass:"no-data-title"},[e("i",{staticClass:"fa fa-fw fa-info-circle"}),t._v(t._s(t.$t("No Script Set has ever been imported")))]),t._v(" "),e("p",{staticClass:"no-data-tip"},[t._v("\n          "+t._s(t.$t("Add external Script Sets by importing Script Sets"))+"\n        ")])]):[e("el-timeline",t._l(t.data,(function(a){return e("el-timeline-item",{key:a.id,attrs:{placement:"top",size:"large",type:"primary",timestamp:"".concat(t.T.getDateTimeString(a.createTime)," (").concat(t.T.fromNow(a.createTime),")")}},[e("el-card",{staticClass:"history-card",attrs:{shadow:"hover"}},[t._l(t.C.IMPORT_DATA_TYPE,(function(o){return[t.T.notNothing(a.summaryJSON[o.key])?e("div",{staticClass:"history-summary"},[e("span",{staticClass:"text-info"},[t._v(t._s(t.$t(o.name))+t._s(t.$t(":")))]),t._v(" "),e("p",t._l(a.summaryJSON[o.key],(function(a){return e("span",{key:a.id},[e("span",{class:o.showClass},[t._v(t._s(a[o.showField]||a.id))]),t._v("\n                      　\n                      "),e("small",[t._v("\n                        "+t._s(t.$t("("))+"\n                        "),e("span",{staticClass:"text-info"},[t._v("ID")]),t._v("\n                         "),e("code",{staticClass:"text-main"},[t._v(t._s(a.id))]),t._v("\n                        "+t._s(t.$t(")"))+"\n                      ")]),t._v(" "),e("br")])})),0)]):t._e()]})),t._v(" "),t.T.notNothing(a.note)?e("div",{staticClass:"history-note"},[e("span",{staticClass:"text-info"},[t._v(t._s(t.$t("Note"))+t._s(t.$t(":")))]),t._v(" "),e("pre",{staticClass:"text-info text-small"},[t._v(t._s(a.note))])]):t._e()],2)],1)})),1)]],2),t._v(" "),e("el-footer",[e("div",{staticClass:"setup-page-footer"},[e("el-button",{on:{click:function(e){return t.openSetup(null,"import")}}},[e("i",{staticClass:"fa fa-fw fa-cloud-upload"}),t._v("\n          "+t._s(t.$t("Script Set Import"))+"\n        ")])],1)]),t._v(" "),e("ScriptSetImport",{ref:"setup"})],1)],1)},r=[],n=a("c7eb"),s=a("1da1"),i=(a("d3b7"),a("159b"),function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{id:"ScriptSetSetup",visible:t.show,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"750px"},on:{"update:visible":function(e){t.show=e}}},[e("template",{slot:"title"},[t._v("\n    "+t._s(t.$t("Script Set Import"))+"\n  ")]),t._v(" "),e("el-container",{attrs:{direction:"vertical"}},[e("el-main",[e("div",{staticClass:"setup-form"},[e("el-form",{ref:"form",attrs:{"label-width":"135px"}},[e("el-form-item",{attrs:{label:t.$t("Select a file"),prop:"upload"}},[e("el-upload",{ref:"upload",class:t.uploadAreaBorderClass,attrs:{drag:"",limit:2,multiple:!1,"auto-upload":!1,"show-file-list":!1,accept:".zip","http-request":t.handleUpload,"on-change":t.onUploadFileChange}},[e("i",{staticClass:"fa",class:t.uploadAreaIconClass}),t._v(" "),e("div",{staticClass:"el-upload__text"},[t._v(t._s(t.$t(t.uploadAreaIconText)))])]),t._v(" "),e("InfoBlock",{attrs:{type:"warning",title:t.$t("Imported contents do not include sensitive data (such as password), please re-entered them after import")}})],1),t._v(" "),e("el-form-item",{staticClass:"setup-footer"},[e("el-button",{directives:[{name:"prevent-re-click",rawName:"v-prevent-re-click"}],attrs:{type:"primary",disabled:t.disableUpload},on:{click:t.submitData}},[t._v(t._s(t.$t("Import")))])],1)],1)],1)]),t._v(" "),e("el-dialog",{attrs:{title:t.$t("Importing"),visible:t.showConfirm,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!0,width:"750px"},on:{"update:visible":function(e){t.showConfirm=e}}},[e("span",{staticClass:"import-info-dialog-content"},[t.importInfo&&t.importInfo.diff?[t._l(t.C.IMPORT_DATA_TYPE,(function(a){return[t.T.notNothing(t.importInfo.diff[a.key])?[e("el-divider",{attrs:{"content-position":"left"}},[e("h1",[t._v(t._s(a.name))])]),t._v(" "),e("el-table",{attrs:{data:t.importInfo.diff[a.key],"show-header":!1}},[e("el-table-column",{attrs:{width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("strong",{class:t.DIFF_TYPE_MAP[a.row.diffType].class},[e("i",{staticClass:"fa",class:t.DIFF_TYPE_MAP[a.row.diffType].icon}),t._v("\n                      "+t._s(t.$t(a.row.diffType))+"\n                    ")])]}}],null,!0)}),t._v(" "),e("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(o){return[e("span",[t._v(t._s(o.row[a.showField]||o.row.id))])]}}],null,!0)}),t._v(" "),e("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(a){return[e("small",[e("span",{staticClass:"text-info"},[t._v("ID")]),t._v("\n                       "),e("code",{staticClass:"text-main"},[t._v(t._s(a.row.id))])])]}}],null,!0)})],1)]:t._e()]}))]:t._e(),t._v(" "),t.importInfo&&t.importInfo.note?[e("el-divider",{attrs:{"content-position":"left"}},[e("h1",[t._v(t._s(t.$t("Note")))])]),t._v(" "),e("pre",{staticClass:"import-note"},[t._v(t._s(t.importInfo.note))])]:t._e()],2),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.showConfirm=!1}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{directives:[{name:"prevent-re-click",rawName:"v-prevent-re-click"}],attrs:{type:"primary",loading:t.isImporting},on:{click:t.confirmImport}},[t._v("\n          "+t._s(t.$t("Confirm"))+"\n        ")])],1)])],1)],2)}),c=[],l=(a("a434"),{name:"ScriptSetImport",components:{},watch:{show:function(t){t||this.$root.$emit("reload.scriptSetImportHistoryList")},showConfirm:function(t){!1===t&&this.initFilePreview()}},methods:{loadData:function(){var t=this;return Object(s["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.show=!0;case 1:case"end":return e.stop()}}),e)})))()},submitData:function(){var t=this;return Object(s["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.upload.submit();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},handleUpload:function(t){var e=this;return Object(s["a"])(Object(n["a"])().mark((function a(){var o,r;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o=new FormData,o.append("checkOnly",!0),o.append("files",t.file),a.next=5,e.T.callAPI("post","/api/v1/script-sets/do/import",{body:o});case 5:if(r=a.sent,r.ok){a.next=8;break}return a.abrupt("return",e.alertOnError(r));case 8:e.importInfo=r.data,e.showConfirm=!0;case 10:case"end":return a.stop()}}),a)})))()},confirmImport:function(){var t=this;return Object(s["a"])(Object(n["a"])().mark((function e(){var a;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isImporting=!0,e.next=3,t.T.callAPI("post","/api/v1/script-sets/do/confirm-import",{body:{confirmId:t.importInfo.confirmId},alert:{okMessage:t.$t("Data imported")}});case 3:if(a=e.sent,t.isImporting=!1,a.ok){e.next=7;break}return e.abrupt("return",t.alertOnError(a));case 7:if(t.showConfirm=!1,t.show=!1,!t.T.notNothing(a.data.requirements)){e.next=14;break}return e.next=12,t.T.confirm(t.$t("Imported Script Set requires 3rd party packages, do you want to open PIP tool now?"));case 12:if(!e.sent){e.next=14;break}return e.abrupt("return",t.common.goToPIPTools(a.data.requirements));case 14:case"end":return e.stop()}}),e)})))()},alertOnError:function(t){t.ok||this.initFilePreview()},initFilePreview:function(){this.$refs.upload.clearFiles(),this.uploadAreaBorderClass=[],this.uploadAreaIconClass=["fa-cloud-upload"],this.uploadAreaIconText="Drag and drop the file here, or click here to upload"},showFilePreview:function(t){this.uploadAreaBorderClass=["upload-area-active"],this.uploadAreaIconClass=["fa-cloud-upload","text-main"],this.uploadAreaIconText=t},onUploadFileChange:function(t,e){e.length>1&&e.splice(0,1),this.disableUpload=e.length<=0,this.disableUpload?this.initFilePreview():this.showFilePreview(e[0].name)}},computed:{DIFF_TYPE_MAP:function(){return{add:{icon:"fa-plus",class:"text-good"},replace:{icon:"fa-refresh",class:"text-bad"}}}},props:{},data:function(){return{show:!1,scriptSetMap:{},uploadAreaBorderClass:[],uploadAreaIconClass:["fa-cloud-upload"],uploadAreaIconText:"Drag and drop the file here, or click here to upload",disableUpload:!0,showConfirm:!1,isImporting:!1,importInfo:{}}}}),p=l,d=(a("2a0d"),a("b2d9"),a("2877")),u=a("fcf7"),f=Object(d["a"])(p,i,c,!1,null,"49f86265",null);"function"===typeof u["default"]&&Object(u["default"])(f);var m=f.exports,h={name:"ScriptSetImportHistoryList",components:{ScriptSetImport:m},watch:{$route:{immediate:!0,handler:function(t,e){var a=this;return Object(s["a"])(Object(n["a"])().mark((function t(){return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.loadData();case 2:case"end":return t.stop()}}),t)})))()}}},methods:{loadData:function(){var t=this;return Object(s["a"])(Object(n["a"])().mark((function e(){var a;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.T.callAPI_get("/api/v1/script-set-import-history/do/list",{query:{pageSize:20}});case 2:if(a=e.sent,a&&a.ok){e.next=5;break}return e.abrupt("return");case 5:a.data.forEach((function(e){e.summaryJSON&&e.summaryJSON.dataSources&&(e.summaryJSON.connectors=e.summaryJSON.dataSources),t.T.isNothing(e.note)&&(e.note=t.T.jsonFindSafe(e,"summaryJSON.extra.note"))})),t.data=a.data,t.$store.commit("updateLoadStatus",!0);case 8:case"end":return e.stop()}}),e)})))()},openSetup:function(t,e){switch(e){case"import":this.$refs.setup.loadData();break}}},computed:{},props:{},data:function(){return{data:[]}},created:function(){var t=this;this.$root.$on("reload.scriptSetImportHistoryList",(function(){return t.loadData()}))},destroyed:function(){this.$root.$off("reload.scriptSetImportHistoryList")}},_=h,v=(a("2cc3"),a("ac55")),w=Object(d["a"])(_,o,r,!1,null,"174ae91f",null);"function"===typeof v["default"]&&Object(v["default"])(w);e["default"]=w.exports},"2a0d":function(t,e,a){"use strict";a("c189")},"2cc3":function(t,e,a){"use strict";a("b01d")},"88ff":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"zh-CN":{"No Script Set has ever been imported":"从未导入过任何脚本集","Add external Script Sets by importing Script Sets":"使用脚本集导入功能添加外部脚本集"}}'),delete t.options._Ctor}},a434:function(t,e,a){"use strict";var o=a("23e7"),r=a("7b0b"),n=a("23cb"),s=a("5926"),i=a("07fa"),c=a("3511"),l=a("65f0"),p=a("8418"),d=a("083a"),u=a("1dde"),f=u("splice"),m=Math.max,h=Math.min;o({target:"Array",proto:!0,forced:!f},{splice:function(t,e){var a,o,u,f,_,v,w=r(this),b=i(w),I=n(t,b),S=arguments.length;for(0===S?a=o=0:1===S?(a=0,o=b-I):(a=S-2,o=h(m(s(e),0),b-I)),c(b+a-o),u=l(w,o),f=0;f<o;f++)_=I+f,_ in w&&p(u,f,w[_]);if(u.length=o,a<o){for(f=I;f<b-o;f++)_=f+o,v=f+a,_ in w?w[v]=w[_]:d(w,v);for(f=b;f>b-o+a;f--)d(w,f-1)}else if(a>o)for(f=b-o;f>I;f--)_=f+o-1,v=f+a-1,_ in w?w[v]=w[_]:d(w,v);for(f=0;f<a;f++)w[f+I]=arguments[f+2];return w.length=b-o+a,u}})},ac55:function(t,e,a){"use strict";var o=a("88ff"),r=a.n(o);e["default"]=r.a},b01d:function(t,e,a){},b2d9:function(t,e,a){"use strict";a("e508")},c189:function(t,e,a){},c5f3:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"zh-CN":{"Select a file":"选择文件","Data imported":"数据已导入","Importing":"即将导入","Imported contents do not include sensitive data (such as password), please re-entered them after import":"导入内容不包含敏感数据，请在导入后重新输入","Drag and drop the file here, or click here to upload":"将文件拖到此处，或点击此处上传","Imported Script Set requires 3rd party packages, do you want to open PIP tool now?":"导入的脚本集需要第三方包，是否现在前往 PIP 工具？"}}'),delete t.options._Ctor}},e508:function(t,e,a){},fcf7:function(t,e,a){"use strict";var o=a("c5f3"),r=a.n(o);e["default"]=r.a}}]);